!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var s in n)("object"==typeof exports?exports:t)[s]=n[s]}}(window,(function(){return function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/js/cmpld/",n(n.s=576)}({0:function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},1:function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=s=function(t){return n(t)}:t.exports=s=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},s(e)}t.exports=s},10:function(t,e,n){"use strict";var s,i;Object.defineProperty(e,"__esModule",{value:!0}),e.DOM_DATA_COMPONENT_SEL="[data-mp]",e.DOM_DATA_COMPONENT_NAME_ATTR="data-mp",e.DOM_DATA_COMPONENT_EL_ATTR="data-mp-el",e.DOM_DATA_COMPONENT_STATE_ATTR="data-mp-state",e.DOM_DATA_COMPONENT_BIND_ATTR="data-mp-bind",function(t){t[t.STRING=0]="STRING",t[t.BOOLEAN=1]="BOOLEAN",t[t.NUMERIC=2]="NUMERIC"}(s=e.MPFProperty||(e.MPFProperty={})),function(t){t[t.STRING=0]="STRING",t[t.BOOLEAN=1]="BOOLEAN"}(i=e.MPFAttributeType||(e.MPFAttributeType={})),e.DOM_ELEMENT_ATTRIBUTES={required:i.BOOLEAN,checked:i.BOOLEAN,disabled:i.BOOLEAN,selected:i.BOOLEAN},e.DOM_ELEMENT_PROPERTIES={alt:s.STRING,id:s.STRING,name:s.STRING,innerHTML:s.STRING,src:s.STRING,style:s.STRING,textContent:s.STRING,title:s.STRING,for:s.STRING,value:s.STRING,colspan:s.NUMERIC,height:s.NUMERIC,maxlength:s.NUMERIC,rowspan:s.NUMERIC,width:s.NUMERIC}},100:function(t,e,n){(0,n(22).init)({templatesNS:"fest"})},101:function(t,e,n){n(102),n(103),n(104),n(105),n(106),n(107)},102:function(t,e,n){var s=n(0)(n(1));!function(t,e,n,i){"use strict";var o=n.Basic,r=o.typeOf,a=o.Extend,l=n.Tools,c=n.Comp.jQuery,u=l.Auth,h=c.Elems.jWindow,d=i&&i.csstransforms&&i.csstransitions;if(d)var p={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"}[i.prefixed("transition")];var m=o.getConstructor(function(){var i=c.Tools.getElements;function o(){var s=this,i=this._Elems,o=this._opts,a=o.cssSels,c=a.Main,u=o.cssClss,d=this._Model,p=this._State,m=u.sending,w=i.jSubmit;d.bind("formrequest",v.bind(this)),d.bind("errorsend",(function(){w.removeClass(m)})),d.bind("beforegetpage",(function(t){t.isNext||i.jWanderForm.detach()})),d.bind("commentpost",(function(){i.jSubmit.removeClass(m),i.jParent.find(c.textarea).val("").trigger("change"),i.jWanderForm.detach()})),o.handleScroll&&(d.bind("pageresize",(function(t){var e=t.message;e&&!1===e.pagerFixationChanged||(p.wrapHeight=i.jWrap.outerHeight(),p.bFixForm=!0,g.call(s))})),d.bind("scrollchange",(function(t){var e=t.scrollExcessBottom||0;p.scrollLimitTop=t.scrollLimitTop||0,p.scrollExcessBottom!=e&&(p.scrollExcessBottom=e,i.jFixedForm.css("bottom",e))})),n.Comp.jQuery.Tools.winHndlrs.attach((function(t,e,n){var r,a,l,c=i.jParent,u=!1;"resize"==n&&(l=c.offset(),a=i.jWrap,p.wrapWidth=c.parent().width(),p.wrapHeight=a.outerHeight(),p.wrapTop=a.offset().top,p.formLeft=l.left,u=!0),o.handleScroll&&!p.isFixed&&(r=(l||c.offset()).top-t.top-p.scrollLimitTop,d.reportEvent("scrollchange",{scrollExcessTop:r>0?0:r})),g.call(s,t,e,u)})),(h||t(e)).on("load",f.bind(s)),i.jFixedForm.on("mouseup",f.bind(s))),w.on("click",function(e){e.preventDefault();var n=this._opts.cssSels,s=t(e.currentTarget),i=s.parents(n.form),a=o.beforeSubmit;s.hasClass(m)||Promise.resolve(r(a,"function")?a.call(this,i):null).then(function(t){if(!1!==t){var e,n=i.find(c.textarea),r=n.val(),a=r.length;a>=o.minLength?(s.addClass(m),o.showInlineError&&(i.removeClass(o.cssClss.formError),i.find(o.cssSels.errorTextEmpty).hide()),a>o.maxLength&&n.val(r.substr(0,o.maxLength)),d.postComment((e={},i.find(":input").each((function(t,n){n.name&&(e[n.name]=n.value)})),e))):o.showInlineError?(i.addClass(o.cssClss.formError),i.find(o.cssSels.errorTextEmpty).show()):d.reportError(o.errorEmptyComment)}}.bind(this))}.bind(this)),i.jParent.on("click",a.authLink,(function(t){var n,s=this.getAttribute("data-"+o.redirectDataAttr);s&&(n={returnPage:s,failPage:e.location.href}),l.jQuery.showLoginPopup(n||{}),t.preventDefault()})).on("click",a.rulesLink,(function(e){var n=o.handleRulesLink;n?n.call(s,e,"form"):(e.preventDefault(),t(a.rulesPopup).Popup(null,"Show"))})),i.jTextarea.on("keydown",(function(e){(e.ctrlKey||e.metaKey)&&13==e.which&&t(this).parents(a.form).find(a.Main.submit).trigger("click")}));var b,y=i.jFixedForm.find(c.textarea);if(u.formShort){var C=_.bind(this,s);y.on("keyup change",(function(){var e=!t.trim(y.val());e!=b&&(b=e,C())}))}}function f(){var t=this._State,n=this._Elems,s=n.jFixedForm.height();t.formHeight=s,this._Model.reportEvent("scrollchange",{scrollLimitBottom:s}),t.isFixed&&(n.jWrap[0].style[this._opts.parentSizeProp]=s+"px");var i=document.createEvent("HTMLEvents");i.initEvent("resize",!0,!0),e.dispatchEvent(i)}function g(t,e,n){n=n||!1;var s,i,o,r,a=this._State,l=this._Elems,c=this._opts,u=l.jFixedForm,d=u.data("width"),p=a.formLeft;a.bFixForm&&(t||(t={top:h.scrollTop(),left:h.scrollLeft()}),e||(e={width:h.width(),height:h.height()}),r=t.left,s=e.width,(o=(i=t.top<=a.wrapHeight+a.wrapTop-e.height+c.scrollCorrection)?a.wrapWidth:"100%")!=d&&(u.width(o).data("width",o),a.formHeight=u.height()),(a.isFixed!=i||n)&&(a.isFixed=i,a.winScrollLeft=r,u.toggleClass(c.cssClss.formFixed,i),u.css("left",i?p-r:0),l.jWrap[0].style[c.parentSizeProp]=i?a.formHeight+"px":0),a.winScrollLeft==r&&a.winWidth==s||(a.winScrollLeft=r,a.winWidth=s,u.css("left",i?p-r:0)))}function _(){var e=this._opts.cssClss,n=e.Avatar,s=this._opts.cssSels,i=this._Elems.jFixedForm,o=i.find(s.Main.textarea),r=i.find(s.Main.avatar),a=!t.trim(o.val());e.formShort&&(i.toggleClass(e.formShort,a),d?i.one(p,f.bind(this)):f.call(this),a?r.removeClass(n.large).addClass(n.small):r.removeClass(n.small).addClass(n.large))}function v(t){var e=this._opts,n=e.cssSels,s=e.beforeAddForm,i=e.afterAddForm;Promise.resolve(!r(s,"function")||s.call(this)).then(function(s){if(s){var o=this._Elems.jWanderForm,a=o.find(n.Main.textarea).val("").trigger("change");o.find(n.commentId).val(t.commentId),o.find(n.form).removeClass(e.cssClss.formError),t.formWrap.append(o),r(i,"function")&&i.call(this),setTimeout((function(){a.focus()}),100),this._Model.reportEvent("addform",{activeComment:t.comment})}}.bind(this))}function w(t){var e=this._Elems.jAvatar,n=this._opts.handleAvatarUrl,i="//cp-filin.mail.ru/pic?"+encodeURI("width=90&height=90&email="+t);function o(t){e.css({"background-image":"url("+t+")"})}if(t&&e&&e.length)if("function"==typeof n){var r=n.call(this,t);null==r?o(i):"string"==typeof r?o(r):"object"===(0,s.default)(r)&&("then"in r?r.then((function(t){o("string"==typeof t?t:i)})):o(i))}else o(i)}var b={cssSels:{Main:{fixedForm:".js-comments_form_fixed",wanderForm:".js-comments_form_wander",submit:".js-comments_form_submit",textarea:".js-comments_form_text",avatar:".js-avatar"},form:".js-comments_form",commentId:".js-comment_id",wrap:".js-comments",authLink:".js-comments_auth",rulesLink:".js-comments_rules",rulesPopup:"#box-notice",errorTextEmpty:".js-error-text_empty"},cssClss:{sending:"",formFixed:"",formShort:"",formError:"comment-form_error",Avatar:{small:"avatar_size_45",large:"avatar_size_90"}},redirectDataAttr:"redirect",parentSizeProp:"paddingBottom",minLength:2,maxLength:5e3,errorEmptyComment:"emptyComment",handleScroll:!0,scrollCorrection:0,beforeSubmit:null,beforeAddForm:null,afterAddForm:null,handleRulesLink:null};return{_Init:function(t,e,n){var s,r,l,c,h,d=t.data("_commentForm"),p=w.bind(this);if(d instanceof m)return d;t.data("_commentForm",this),this._Model=e,this._opts=s=a(!0,{},b,n),this._Elems=r=i(s.cssSels.Main,t,{jParent:t,jWrap:t.find(s.cssSels.wrap).add(t.closest(s.cssSels.wrap)).eq(0)}),h=e.getState(),l=r.jWrap,this._State={bFixForm:!!s.commentsCount,wrapTop:l.offset().top,wrapHeight:l.outerHeight(),wrapWidth:t.parent().width(),formLeft:t.offset().left,formHeight:r.jFixedForm.height(),scrollLimitTop:h.scrollLimitTop||0,scrollExcessBottom:0},u.onGetStatus(p),u.on("authChange",p),o.call(this),_.call(this),!0===h.reply&&(c=r.jFixedForm.find(s.cssSels.Main.textarea),setTimeout((function(){c.focus()}),500))}}}());t.fn.commentForm=function(n,s){return e.DEBUG&&e.console.warn("Обнаружено старое подключение компонента.\t\t\t\tНеобходимо срочно сменить его на обычное, так как скоро старое перестанет работать"),this.each((function(){new m(t(this),n,s)}))},e.getNameSpace("Comp.jQuery.Comments",n).commentForm=m}(window.jQuery,window,window.ru.mail.cpf,window.Modernizr)},103:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.Extend,o=s.typeOf,r=n.Tools,a=r.Auth,l=n.Comp.jQuery,c=l.Elems,u=r.jQuery.showLoginPopup,h=s.getConstructor(function(){function n(){var n=this,s=this._opts,i=this._Elems,a=i.jParent,c=i.jContainer,h=i.jLoading,f=this._Model,g=this._State,_=s.cssSels,v=s.cssClss,w=s.scrollBottom,b=_.comment,y=s.prepareComments;f.bind("getpage",(function(t){m.call(n,t).then((function(){f.reportEvent("pagerendered")}))})),f.bind("addform",(function(t){var s=t.activeComment;s.addClass(v.showForm),d.call(n,s,!0),g.replyTo&&(g.replyTo=!1,e.promisifiedDomEvents.ready.then(r.bind(n,s))),n._Model.reportEvent("pageresize")})),h&&h.length&&f.bind("load",(function(t){h.toggle(t)})),s.handleScroll&&(f.bind("statechange",(function(t){var e=t.winHeightDelta;isNaN(e)||(n._State.winHeightDelta=e)})),f.bind("scrollchange",(function(t){var e=t.scrollLimitBottom||0;g.scrollLimitBottom!=e&&(g.scrollLimitBottom=e)})),l.Tools.winHndlrs.attach((function(t,s,o){var r,l,u,h,d,p,m=t.top,v=n._Pages,b=v.length;if((p=c)instanceof e.jQuery?p.is(":visible"):0!==p.offsetWidth||0!==p.offsetHeight)if("scroll"==o){for(u=0;u<b&&null!==(r=v[u]);u++){if(l=r.data(),0===u&&(h=parseInt(l.page,10)),!(l.top<=m)){u==b-1&&m>g.top+g.height-s.height&&(h=parseInt(l.page,10));break}h=parseInt(l.page,10)}g.currentPage!=h&&(g.currentPage=h,f.reportEvent("pagechange",{currentPage:h})),!n._isPageRequested&&m>g.top+g.height-s.height-w&&(n._isPageRequested=!0,f.getNextPage(a.find(_.comment).last().data("id")))}else if(n._isPageRequested=!1,d=g.winHeightDelta||0,g.top=i.jContainer.offset().top,r)for(u=0;u<b;u++)(r=v[u]).data("top",r.offset().top-d)}))),s.useNewApi&&f.bind("commentpost",(function(e){var a,l=e.comment,c=n._State,u=s.prepareComments,h=s.commentTemplate;l&&(c.newComment=l.id),s.appendNewComment&&l?Promise.resolve(h).then((function(){a=t(h(l)),o(u,"function")&&u.call(n,a),s.insertToBegin?i.jContainer.prepend(a):i.jContainer.append(a),r.call(n,l.id)})):e.page&&f.getPage(e.page)})),a.on("click",_.replyBtn,(function(e){e.preventDefault();var n=t(this),s=n.parents(b).eq(0);g.user?f.getForm({commentId:s.data("id"),formWrap:s.find(_.formContainer).last(),comment:s}):u({returnPage:n.attr("href")})})).on("click",_.parent,(function(e){e.preventDefault(),d.call(n,p.call(n,t(this).parents(b),v.showParent))})).on("click",_.history,(function(e){e.preventDefault();var i=t(this),r=i.parents(b),a=r.find(_.historyCont),l=i.data("threadLoaded"),c=v.showHistory;l?(p.call(n,r,c,!a.is(":visible")),d.call(n,r)):f.getHistory(r.data("id"),(function(t){i.data("threadLoaded",!0),a.html(t);var e=a.find(_.comment).data("included",!0);o(y,"function")&&y.call(n,e),p.call(n,r,c,!0),d.call(n,r,!0)}),s.commentTemplate)})).on("click",_.showMore,(function(e){e.preventDefault(),t(this).parents(_.comment).addClass(v.showMore)})).on("click",_.rulesLink,(function(e){var i=s.handleRulesLink;i?i.call(n,e,"list"):(e.preventDefault(),t(_.rulesPopup).Popup(null,"Show"))}))}function s(t){return this._Elems.jContainer.find("#"+this._opts.commentIdPrefix+t)}function r(t,e){isNaN(t)||(t=s.call(this,t)),t.length&&(!0===e&&d.call(this,t,e),this._opts.disableScrollToBlock||this._Elems.jScrollBlock.animate({scrollTop:t.offset().top+this._opts.scrollDeltaTop-(this._State.winHeightDelta||0)}))}function d(e,n){var s,i,r,a,l,u,h,d=this._opts,p=this._Elems,m=d.cssClss,f=d.cssSels,g=m.active,_=m.showForm,v=e.data("included"),w=v?_:g+" "+_+" "+m.showHistory+" "+m.showParent,b=!1;o(n,"undefined")?e.find(f.parentCont+","+f.historyCont+",form").each((function(){if(t(this).is(":visible"))return b=!0,!1})):b=n,b&&p.jContainer.find("."+g+", ."+_).not(e).removeClass(w),v||e.toggleClass(g,b),b&&(l=(a=c.jWindow).scrollTop(),i=(s=e.offset().top)+d.scrollDeltaTop,r=l+a.height()-this._State.scrollLimitBottom,s+(u=e.outerHeight())>r&&(h=!0,a.scrollTop(l-r+s+u)),i<(h?a.scrollTop():l)&&a.scrollTop(i)),d.handleScroll&&this._Model.reportEvent("pageresize",{pageHeight:p.jParent.outerHeight()})}function p(t,e,n){var s=this._opts.cssClss,i=s.showParent;return t.toggleClass(e,n).removeClass(e==i?s.showHistory:i)}function m(e){var n,s,i,a,l,u,h=this._Elems,d=this._opts,p=h.jContainer,m=h.jCommentsCount,f=e.commentsList,g=h.jPagesContainer,_=h.jParent,v=c.jWindow,w=e.reply,b=h.jScrollBlock,y=d.prepareComments,C=d.commentTemplate;return!w&&this._State.newComment&&(w=this._State.newComment,delete this._State.newComment),e.topicId&&(this._State.topicId=e.topicId),Promise.resolve(C).then(function(){if(o(C,"function")&&(f=f.map(C)),l=t(t.trim(f.join(""))),u=l.eq(0).data("page",e.currentPage),o(y,"function")&&y.call(this,l),e.isPrev)p.prepend(l),u.length&&this._Pages.push(u.data("top",u.offset().top));else if(e.isNext)p.append(l),u.length&&this._Pages.push(u.data("top",u.offset().top));else if(p.empty().append(l),u.length&&(this._Pages=[u.data("top",u.offset().top)]),!d.disableScrollToBlock){var c=this._Model,P=c.getState().comment,S=l.filter("[data-id="+w+"]"),I=l.filter("[data-id="+P+"]");if(S.length)n=S.offset().top+S.outerHeight()-v.height()+d.scrollCorrectBottom;else{if(I.length)return r.call(this,P,!0),void c.removeCommentIdFromUrl();n=e.isLast||w?_.offset().top+_.outerHeight()-v.height()+d.scrollCorrectBottom:h.jPagesContainer.offset().top+d.scrollCorrectTop-(this._State.winHeightDelta||0)}b.animate({scrollTop:n})}g.data("visible")||(g.data("visible",!0).show(),this._Model.reportEvent("pagechange",e)),w&&(i=d.cssClss.active,s=l.filter("#"+d.commentIdPrefix+w).addClass(i),setTimeout((function(){s.removeClass(i)}),d.newCommentActiveTime)),d.handleScroll&&(this._Model.reportEvent("pageresize",{pageHeight:_.outerHeight(!0)}),v.trigger("scroll")),m&&(a=e.commentsCount,m.text(a),0===d.commentsCount&&(d.commentsCount=a,m.parents(d.cssSels.commentsCountWrap).show())),this._isPageRequested=!1,this._State.height=p.height()}.bind(this))}function f(t){var n,i=this._opts,o=this._State,r=this._Model,a=o.replyToId;o.user=t,t?(this._Elems.jParent.addClass(i.cssClss.authorized),isNaN(a)||(o.replyToId=null,(n=s.call(this,a)).length&&(o.replyTo=!0,r.getForm({commentId:a,formWrap:n.find(i.cssSels.formContainer),comment:n})))):e.promisifiedDomEvents.ready.then((function(){if(a){o.replyToId=null;var t=e.location,n=r._opts.urlParams,s=isNaN(a)?n.addComment:n.replyToComment+a,i=t.pathname+t.search+"#"+s;u({returnPage:i})}}))}var g={cssSels:{Main:{container:".js-comments_list",commentsCount:".js-comments-cnt",pagesContainer:".js-comments_pages",loading:".js-comments_loading"},commentsCountWrap:".js-comments_cnt_wrp",comment:".js-comments_comment",history:".js-comments_history",parent:".js-comments_parent",historyCont:".js-comments_history_cont",parentCont:".js-comments_parent_cont",replyBtn:".js-comments_reply",formContainer:".js-comments_form_cont",rulesLink:".js-comments_rules",rulesPopup:"#box-notice",showMore:".js-comments_toggle"},cssClss:{loading:"",active:"",showHistory:"",showParent:"",showForm:"",authorized:"",showMore:""},prepareComments:null,newCommentActiveTime:3e3,commentIdPrefix:"comment_",currentPage:null,commentsCount:null,handleScroll:!0,scrollBottom:300,scrollDeltaTop:0,scrollCorrectTop:-1,scrollCorrectBottom:1,useNewApi:!1,appendNewComment:!1,insertToBegin:!1,handleRulesLink:null,disableScrollToBlock:!1,requestCommentPage:!1};return{_Init:function(c,u,d){var p,m,_,v,w,b,y,C,P,S=c.data("_commentsList"),I=this,T=u.getState(),E=f.bind(this);if(S instanceof h)return S;c.data("_commentsList",this),this._Model=u,this._opts=p=i(!0,{},g,d),m=p.cssSels,this._Elems=_=l.Tools.getElements(m.Main,c,{jParent:c}),_.jScrollBlock=t("html, body"),v=_.jContainer,(w=_.jPagesContainer).data("visible",w.is(":visible")),y=(b=v.find(m.comment)).eq(0),C=p.currentPage,this._State={top:v.offset().top,height:v.height(),currentPage:C,scrollLimitBottom:T.scrollLimitBottom||0,replyToId:T.reply},this._Pages=[y.length?y.data({top:y.offset().top,page:C}):null],P=p.prepareComments,o(P,"function")&&P.call(this,b),n.call(this),T.comment&&e.promisifiedDomEvents.ready.then((function(){s.call(I,T.comment).length?r.call(I,T.comment,!0):I._opts.requestCommentPage&&(u.addCommentIdToUrl(T.comment),u.getPage(T.currentPage))})),a.onGetStatus(E),a.on("authChange",E)}}}());t.fn.commentsList=function(n,s){return e.DEBUG&&e.console.warn("Обнаружено старое подключение компонента.\t\t\t\tНеобходимо срочно сменить его на обычное, так как скоро старое перестанет работать"),this.each((function(){new h(t(this),n,s)}))},e.getNameSpace("Comments",l).commentsList=h}(window.jQuery,window,window.ru.mail.cpf)},104:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=n.Comp,o=n.Tools,r=s.Extend,a=s.typeOf,l=i.Methods.initCallbacks,c=o.Auth.onGetStatus,u=n.Types.String.Url,h=u.addParams,d=u.getParams,p=n.Instances.stateObject,m=o.Cookie||t.cookie,f=function(){},g=s.getConstructor(function(){var n={cssSels:{errorDescr:null},urlParams:{postUrl:null,commentsUrl:null,historyUrl:null,extraParams:{post:null,comments:null,history:null},topicParam:"tid",pageParam:"page",commentParam:"comment_id",lastParam:"last",lastPageVal:"last",replyToComment:"reply_",addComment:"add_comment",targetComment:"comment_"},transport:function(){return o.transport.apply(null,arguments)},allowPageInCommentRequest:!0,allowSetPage:!0,texts:null,commentsPerPage:25,newRequestDelay:6e4,currentPage:null,currentTopPage:null,totalPages:null,topicId:null,onBeforeGetPage:null,onGetPage:null,onPageChange:null,onPageResize:null,onPost:null,onFormRequest:null,onAddForm:null,onStateChange:null,onScrollChange:null,errorSend:"sendError",errorRequest:"requestError",preparePageResponse:null,prepareHistoryResponse:null,useNewApi:!1};function s(t,e){var n=this._opts.urlParams,s=n.extraParams&&n.extraParams.comments,i=s&&s[n.commentParam],o=this._opts.allowPageInCommentRequest,a=n.lastParam,l=this._State,c={};return c[n.topicParam]=l.topicId,t==a?c[a]=1:i&&!o||(c[n.pageParam]=e?Math.min(l.currentPage+1,l.totalPages):t),s&&r(c,s),h(c,n.commentsUrl)}function u(t){var n,s=parseInt(t.currentPage,10),i=this._opts.urlParams.pageParam,o=e.location.href.replace(/[?#].*$/,""),a=d(e.location.href)||{};if(1!==s?a[i]=s:delete a[i],n={__location:{url:h(a,o,!0)}},r(!0,n,a),this._opts.preparePageParams){var l={href:o,params:a};n=this._opts.preparePageParams.call(this,n,l,t)}p.pushToState(n,!1,!0)}function g(t){t?this._AuthDeferred.resolve():(o.jQuery.showLoginPopup(),this._AuthDeferred.reject())}function _(t,e){var n=t?"errorRequest":"errorSend";this.reportError(this._opts[n],e&&e.message),this._fire(n.toLowerCase(),[e||null])}function v(t){var e=this,n=this._opts,s=n.preparePostCommentResponse,i=n.useNewApi&&a(m,"function")?{"X-CSRFToken":m("Mpop")}:{};n.transport({url:n.urlParams.postUrl,data:t,type:"POST",headers:i}).then((function(t){if(n.useNewApi)t.topicId&&(e._State.topicId=t.topicId),t.status?e._fire("commentpost",[t]):_.call(e,!1,{message:t.msg,data:t});else{a(s,"function")&&(t=s(t));var i=t.comments;!t.error&&i.commentsList&&i.commentsList.length?(i.reply=t.reply,t.comments.topicId&&(e._State.topicId=t.comments.topicId),e._fire("commentpost",[i]),w.call(e,i)):_.call(e,!1,t.error)}}),_.bind(e,!1))}function w(t,e){var n=this,s=this._State,i=parseInt(t.currentPage,10),o=parseInt(t.totalPages,10);t.isPrev||(s.currentPage=i),t.isNext||(s.currentTopPage=i),s.totalPages=o,s.totalComments=t.commentsCount,this._fire("beforegetpage",[t]),this._fire("getpage",[t]),t.isNext||t.isPrev||this._fire("pagechange",[t]),a(e,"function")&&e.call(null,t),i==o&&(this.noRequest=!0,this.ignoreTimeout=setTimeout((function(){n.noRequest=!1}),this._opts.newRequestDelay))}return{_Init:function(t){var s,i,o,a,c,h=p.State();this._opts=s=r(!0,{},n,t),i=s.urlParams,c=parseInt(s.currentPage,10),this._State=o={currentPage:c,currentTopPage:c,totalPages:parseInt(s.totalPages,10),totalComments:parseInt(s.totalComments,10),topicId:s.topicId,reply:i.addComment in h,comment:h[i.targetComment]},l.call(this,{Types:{beforegetpage:s.onBeforeGetPage,getpage:s.onGetPage,pagechange:s.onPageChange,pageresize:s.onPageResize,commentpost:s.onPost,formrequest:s.onFormRequest,addform:s.onAddForm,statechange:s.onStateChange,scrollchange:s.onScrollChange,errorsend:null,errorrequest:null,load:null,pagerendered:null}}),s.allowSetPage&&this.bind("pagechange",u),h[i.pageParam]&&this.getPage(h[i.pageParam]),isNaN(c)&&this.getPage(1),h[i.replyToComment]&&(o.reply=h[i.replyToComment]),o.reply&&(a=e.location,p.pushToState({__location:{url:a.pathname+a.search}},!1,!0))},getState:function(){return r({},this._State)},getPage:function(t,e,n){var i=e&&"previous"!==e,o="previous"===e,r=this,l=this._opts,c=l.preparePageResponse;this._fire("load",[!0]),l.transport({url:s.call(this,t,i)}).then((function(e){var s=l.urlParams;a(c,"function")&&(e=c(e)),e.currentPage&&parseInt(e.currentPage,10)?(e.isNext=i,e.isPrev=o,t!=s.lastParam&&t!=s.lastPageVal||(e.isLast=!0),r._fire("load",[!1]),w.call(r,e,n)):_.call(r,!0)}),_.bind(this))},getNextPage:function(t,e){var n=this._State;n.currentPage!=n.totalPages&&this.getPage(t,!0,e)},reportEvent:function(t,e){r(this._State,e),this._fire(t,[this.getState()]),delete this._State.message},reportError:function(t,e){var n,s=this._opts,o=s.texts,r=s.cssSels.errorDescr;t in o&&(n=o[t],r&&e&&(n.extraElems={},n.extraElems[r]=e),i.jQuery.Tools.Notify(n))},getHistory:function(e,n,s){var i=this._opts,o=i.urlParams,r=i.prepareHistoryResponse,l=_.bind(this),c={};c[o.topicParam]=this._State.topicId,c[o.commentParam]=e;i.transport({url:h(c,o.historyUrl)}).then((function(e){a(r,"function")&&(e=r(e));var i=e.commentsList;i&&i.length?Promise.resolve(s).then((function(){a(s,"function")&&(i=i.map(s)),a(n,"function")&&n.call(null,t.trim(i.join("")))})):l(!0)}),l)},postComment:function(t){a(t,"string")&&-1!==t.indexOf("&")&&(t=t.split("&").reduce((function(t,e){return(e=e.split("=")).length>1?t[e.shift()]=e.join("="):t[e[0]]="",t}),{})),new Promise(function(t,e){this._AuthDeferred={resolve:t,reject:e}}.bind(this)).then(v.bind(this,t),f),c(g.bind(this))},getForm:function(t){new Promise(function(t,e){this._AuthDeferred={resolve:t,reject:e}}.bind(this)).then(this._fire.bind(this,"formrequest",[t]),f),c(g.bind(this))},addCommentIdToUrl:function(t){var e={},n=this._opts.urlParams;e[n.commentParam]=t,n.extraParams.comments=r({},n.extraParams.comments,e)},removeCommentIdFromUrl:function(){var t=this._opts.urlParams,e=t.extraParams;e.comments&&(e.comments[t.commentParam]=null)}}}());e.getNameSpace("Comp.jQuery.Comments",n).commentsManager=g}(window.jQuery,window,window.ru.mail.cpf)},105:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.Extend,o=s.getConstructor(function(){var s,r=n.Comp.jQuery,a=r.Tools;function l(){var e,n=this,i=this._Model,o=this._opts,r=this._Elems,l=this._State,u=r.jWrap,d=r.jWindow;i.bind("pagechange",(function(t){var e=t.totalPages;l.currentPage=t.currentPage,l.totalPages=e,l.isHidden=1==e,p.call(n,t)})),i.bind("scrollchange",(function(t){var e=t.scrollExcessTop||0;l.scrollLimitBottom=t.scrollLimitBottom||0,l.scrollExcessTop!=e&&(l.scrollExcessTop=e,r.jParent.css("top",e+(l.winHeightDelta||0)))})),i.bind("statechange",(function(t){var e=t.winHeightDelta;isNaN(e)||(l.winHeightDelta=e,m.call(n,c(d),!0))})),a.winHndlrs.attach((function(t,o,r){var a,c;"scroll"==r?m.call(n,t):(e=u.offset(),l.wrapTop=e.top,l.wrapLeft=e.left,m.call(n,t,!0),a=s,h.call(n),a!=s&&p.call(n,l)),l.isFixed||(c=t.top+o.height-l.scrollLimitBottom-l.wrapHeight-l.wrapTop,i.reportEvent("scrollchange",{scrollExcessBottom:c>0?0:c}))})),r.jParent.on("click",o.cssSels.button,(function(e){e.preventDefault();var s=t(this).data(),i=o.dataPropName;1!=s.disabled&&n._Model.getPage(s[i]||this.getAttribute("data-"+i))})),d.on("load",(function(){l.wrapTop=u.offset().top}))}function c(t){return{left:t.scrollLeft(),top:t.scrollTop()}}function u(t,e){var n=this._opts,s=n.button,i=n.cssClss,o=s.tagName,r=document.createElement(o);return r.appendChild(document.createTextNode(t)),r.title=s.title+t,r.className=(e?s.className+" "+i.activePage:s.className)+" "+i.button,r.setAttribute("data-"+n.dataPropName,t),e&&r.setAttribute("data-disabled","1"),"a"==o&&(r.href="#"),r}function h(){var t=this._Elems;s=t.jBtnWrap.width()-t.jPrev.outerWidth(!0)-t.jNext.outerWidth(!0)-10}function d(e){var n,s=t("<div />").css({position:"absolute",visibility:"hidden"});return this._Elems.jContainer.append(s.append(u.call(this,e))),n=s.width(),s.remove(),n}function p(t){var e,n,i,o,r,a,l,h=this._opts,p=this._Elems,f=p.jParent,g=p.jContainer,_=h.cssSels,v=document.createDocumentFragment(),w=parseInt(t.currentPage,10),b=parseInt(t.totalPages,10),y=w==b,C=1==w,P=h.dataPropName,S=h.cssClss,I=S.disabledStepBtn,T=S.disabledEndBtn;if(b<=1)return this._State.isHidden=!0,void(h.hiddenByClass&&f.addClass(h.cssClss.hidden)||f.hide());(e=Math.min(Math.floor(s/d.call(this,Math.ceil(w+h.buttonsMax/2))),h.buttonsMax))>3&&e%2==0&&e--,l=(n=function(t,e,n){var s,i,o,r=[];e>=n?(s=1,i=n):e<3?1==n?s=i=1:t!=n?(s=t,i=t+1):(s=n-1,i=n):t-(o=(e-1)/2)>0&&t+o<=n?(s=t-o,i=t+o):t-o<=0?(s=1,i=e):(s=n-e+1,i=n);for(var a=s;a<=i;a++)r.push(a);return r}(w,e,b)).length;for(var E=0;E<l;E++)i=n[E],v.appendChild(u.call(this,i,i==w));g.empty().append(v),p.jNext.data(P,w+1).data("disabled",y?"1":"").toggleClass(I,y),p.jPrev.data(P,w-1).data("disabled",C?"1":"").toggleClass(I,C),(o=p.jLast).data("disabled",y?"1":"").toggleClass(T,y),(a=S.disabledEndNavBtn)&&(r=_.navButton,o.find(r).toggleClass(a,y)),m.call(this,c(p.jWindow),!0),this._State.isHidden||f.is(":visible")||h.hiddenByClass&&f.removeClass(h.cssClss.hidden)||f.show()}function m(t,e){var n,s,i,o,r,a,l,c=this._State,u=c.winHeightDelta||0,h=c.wrapHeight+u,d=t.top,p=t.left,m=d>c.wrapTop-u,f=m!==c.isFixed,g=this._Elems,_=g.jParent,v=c.wrapLeft,w=c.scrollExcessTop||0;(!c.isHidden&&f||e)&&(g=this._Elems,s=(n=this._opts).cssClss,i=g.jWrap,c.winScrollLeft=p,r=m?{width:i.width(),top:u+w,left:v-p}:{width:"100%",top:0,left:0},_.toggleClass(s.fixed,m).css(r),i[0].style[n.parentSizeProp]=m&&_.is(":visible")?_.outerHeight(!0)+"px":0,c.isFixed=m,l=!(parseInt(c.currentPage,10)>1)&&!m,o=g.jFirst.data("disabled",l?"1":"").toggleClass(s.disabledEndBtn,l),(a=s.disabledEndNavBtn)&&o.find(n.cssSels.navButton).toggleClass(a,l),this._Model.reportEvent("pageresize",{message:{pagerFixationChanged:f}})),p!=c.winScrollLeft&&(c.winScrollLeft=p,_.css("left",m?v-p:0)),c.scrollLimitTop!=h&&(c.scrollLimitTop=h,this._Model.reportEvent("scrollchange",{scrollLimitTop:h}))}var f={cssSels:{Main:{First:".js-first",Prev:".js-prev",Next:".js-next",Last:".js-last",Container:".js-comments_page_btn_cont",btnWrap:".js-comments_btnwrap"},button:".js-comments_paging_btn",navButton:".js-nav-button"},cssClss:{disabledEndBtn:"comment-nav__to__link_disabled",disabledEndNavBtn:null,disabledStepBtn:"comment-nav__pages__arr_off",activePage:"comment-nav__pages__link_on",fixed:"comment-controls_fixed",hidden:"hidden_all"},button:{tagName:"a",className:"",title:"Страница "},parentSizeProp:"height",currentPage:null,totalPages:null,hiddenByClass:!1,dataPropName:"page",buttonsMax:9};return{_Init:function(n,s,c){var u,d,m,g,_,v,w=n.data("_commentsPaging");if(w instanceof o)return w;n.data("_commentsPaging",this),this._Model=s,this._opts=u=i(!0,{},f,c),this._Elems=d=a.getElements(u.cssSels.Main,n,{jParent:n,jWindow:r.Elems.jWindow||t(e)}),d.jWrap=g=n.parent(),v=u.totalPages,_=g.offset(),this._State=m={wrapTop:_.top,wrapLeft:_.left,wrapHeight:n.outerHeight(),currentPage:u.currentPage,totalPages:v,isHidden:1==v,isFixed:!1,scrollLimitBottom:s.getState().scrollLimitBottom||0,scrollExcessTop:0,winHeightDelta:0},u.cssClss.button=u.cssSels.button.substr(1),1==v&&(u.hiddenByClass&&n.addClass(u.cssClss.hidden)||n.hide()),h.call(this),p.call(this,m),n.css("visibility","visible"),l.call(this)}}}());t.fn.commentsPaging=function(n,s){return e.DEBUG&&e.console.warn("Обнаружено старое подключение компонента.\t\t\t\tНеобходимо срочно сменить его на обычное, так как скоро старое перестанет работать"),this.each((function(){new o(t(this),n,s)}))},e.getNameSpace("Comp.jQuery.Comments",n).commentsPaging=o}(window.jQuery,window,window.ru.mail.cpf)},106:function(t,e){!function(t,e,n){"use strict";var s,i,o,r,a,l,c,u,h,d,p,m,f,g,_=n.Basic,v=_.Extend,w=_.typeOf,b=n.Tools.Cookie||t.cookie,y=n.Tools.transport,C=_.getConstructor((i=n.Tools.Auth,o=_.moduleOpts,r={cssSels:{Items:null,complainBtn:null,complainBtnText:null},cssClss:{Button:{Complained:null,Avalible:null,Pending:null,Error:null}},uiTexts:{Button:{Complained:null,Avalible:null,Pending:null,Error:null}},forumParams:{topicId:null,forumId:null},cookieStoreParams:{path:null},itemIdAttr:"data-id",onComplain:null,reqUrl:null,useConfirm:!1,confirmMessage:"",oneInstance:!0,useContainer:!0,storePrefix:"comm"},a=function(){var n,s,i,o=!1;try{o="localStorage"in e&&null!==(n=e.localStorage)}catch(t){e.console.info("Не поддерживается работа с Local Storage")}return o||(s=t.cookie,n={getItem:function(t){return s(t)},setItem:(i=function(e,n,i,o){var r=t.extend({expires:e?7:-1},o);s(n,i,r)}).bind(null,!0),removeItem:i.bind(null,!1)}),function(t,e){var s=this._Opts.cookieStoreParams;if(null===e)n.removeItem(t,e,s);else{if(w(e,"undefined"))return n.getItem(t);n.setItem(t,e,s)}}}(),l=function(t,e,n){var s=!w(n,"boolean"),i=[this._Opts.storePrefix+t,e.topicId].join("/");if(s)return 1==a.call(this,i);a.call(this,i,n?1:null)},s=function(e,n,s){var i=this._Params,o=null;null!=s&&(o=t.extend({userId:s},i,n)),e.call(this,o)},c=function(t,e){i.onGetStatus(s.bind(this,t,e))},u=function(t,e,n){var s=e.promise;n.status?(l.call(this,t,e,!0),s.resolve({commentId:t,params:e})):s.reject("BAD_RESPONSE")},h=function(t,e){var n={rid:t,tid:e.topicId};return e.requestData&&v(n,e.requestData),y({url:this._Opts.reqUrl,type:"post",dataType:"json",data:n,csrf:!0,headers:{"X-CSRFToken":b("Mpop")}}).then(u.bind(this,t,e))},d=function(t,e){var n,s,i,o=this._Opts,r=o.cssClss.Button,a=o.uiTexts.Button;if(t&&t.length){for(var l in t.data("disabled","avalible"!=e),r)r.hasOwnProperty(l)&&(s=e==l.toLowerCase(),t.toggleClass(r[l],s),s&&(n=l));n&&(i=a[n])&&t.find(o.cssSels.complainBtnText).text(i)}},p=function(e,n){return new Promise(function(s,i){n=t.extend({promise:{resolve:s,reject:i}},n),c.call(this,(function(t){null!==t?e&&!l.call(this,e,t)?(d.call(this,n.jBtn,"pending"),h.call(this,e,t).catch((function(){i("HTTP_ERROR")}))):i("WRONG_OBJECT"):i("NO_AUTH")}),n)}.bind(this))},m=function(){var e=this,n=this._Opts,s=this._Elems.jList,i=n.cssSels,o=n.itemIdAttr;c.call(this,(function(r){var a=n.useContainer?s.find(i.Items):s;null!=r&&a.each((function(){var n=t(this),s=n.attr(o),a=l.call(e,s,r);s&&d.call(e,n.find(i.complainBtn),a?"complained":"avalible")}))}))},f=function(n){var s=this,i=t(n.currentTarget),o=this._Opts,r=i.parents(o.cssSels.Items),a=r.attr(o.itemIdAttr);if(a&&!i.data("disabled")){if(n.preventDefault(),o.useConfirm&&!e.confirm(o.confirmMessage))return;p.call(this,a,{jBtn:i,jItem:r}).then((function(){var t=o.onComplain;w(t,"function")&&t.call(s),d.call(s,i,"complained")})).catch(function(t){"WRONG_OBJECT"!=t&&"NO_AUTH"!=t&&d.call(this,i,"error")}.bind(this))}},g=function(){var t=this._Opts.cssSels;this._Elems.jList.on("click",t.complainBtn,f.bind(this))},{_Init:function(e,n){var s,i;if(n=t.extend(!0,{},n,o.get("Complain")),(s=t.extend(!0,{},r,n)).oneInstance){if((i=e.data("_complainObj"))instanceof C)return i;e.data("_complainObj",this)}this._Elems={jList:e},this._Opts=s,this._Params=s.forumParams,m.call(this),g.call(this)}}));t.fn.initComplain=function(t){return C(this,t),this}}(window.jQuery,window,window.ru.mail.cpf)},107:function(t,e){!function(t,e,n){var s,i,o,r=n.Basic,a=r.Extend,l=r.typeOf,c={complainOpts:{cssSels:{Items:".js-comments_comment",complainBtn:".js-comments_complaint",complainBtnText:".js-comments_complaint_text"},cssClss:{Button:{Complained:"comment__action_complaint_done",Avalible:"comment__action_complaint_active",Pending:"comment__action_complaint_loading",Error:"comment__action_complaint_error"}},uiTexts:{Button:{Complained:"Жалоба принята. Спасибо!",Error:"Ошибка отправки"}},forumParams:{topicId:null},cookieStoreParams:{path:null},itemIdAttr:"data-id",reqUrl:null,useContainer:!1,oneInstance:!1},deleteOpts:{cssSels:{complainBtn:".js-comments_delete"},cssClss:{Button:{Complained:"comment__action_delete_done",Avalible:"comment__action_delete_active",Pending:"comment__action_delete_loading",Error:"comment__action_delete_error"}},uiTexts:{Button:{Complained:"Сообщение удалено",Error:"Действие недоступно"}},onComplain:function(){},storePrefix:"delete",useConfirm:!0,confirmMessage:"Удалить комментарий?"},adminDeleteOpts:{cssSels:{complainBtn:".js-comments_admin_delete"},forumParams:{topicId:null,requestData:{action:"hide_reply_by_moderator"}}}},u=function(t){var e=this._Model._State.topicId;s&&e&&(s.forumParams.topicId=i.forumParams.topicId=o.forumParams.topicId=e),t.initComplain(s),t.initComplain(i),t.initComplain(o)},h=function(t){var e=t.pager;return{currentPage:e.currentPage,totalPages:e.totalPages,totalComments:e.commentsCount,commentsList:t.list}},d=function(t){var e=t.comments&&t.comments.list;return{commentsList:e&&e.length?e.map((function(t){return t.avatarSize=32,t})):[]}},p=function(t){var e=t.errors;if(e)if(e.form&&e.form.length)t.error={message:e.form[0]};else if(e.fields){var n=e.fields;for(var s in n)if(n.hasOwnProperty(s)&&n[s].length){t.error={message:n[s][0]};break}}else l(e,"string")&&(t.error={message:e});return t},m=r.getConstructor({_Init:function(t){var e=a(!0,{},c,t);s=e.complainOpts,i=a(!0,{},s,e.deleteOpts,{reqUrl:e.deleteUrl}),o=a(!0,{},i,e.adminDeleteOpts,{reqUrl:e.adminUrl})},prepareComments:u,preparePageResponse:h,prepareHistoryResponse:d,preparePostCommentResponse:p});e.getNameSpace("Comp.jQuery.Comments",n).prepareComments=m}(window.jQuery,window,window.ru.mail.cpf)},11:function(t,e,n){"use strict";var s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(9),o=n(5),r={},a=[];function l(t){return s({},r[t])}e.resolveConfigSetters=function(){return new Promise((function(t){for(var e=0,n=a;e<n.length;e++){(0,n[e])()}t(s({},r))}))},e.getConfig=l,e.setConfig=function(t,e){var n=function(){r[t]=s({},e)};return a.push(n),n},e.getConfigCollapsed=function(t){for(var e=t.split(o.COMPONENT_NS_DELIMITER),n=e[0],s={},r=0,a=e.slice(1);r<a.length;r++){var c=a[r];s=i.deepMerge({},s,l(n)),n=""+n+o.COMPONENT_NS_DELIMITER+c}return i.deepMerge({},s,l(n))}},16:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(9),i=n(17),o=n(5),r=n(10),a=n(4),l=n(11);function c(t){var e=function(t){var e=t.getAttribute(r.DOM_DATA_COMPONENT_STATE_ATTR)||"{}";try{return JSON.parse(e)||{}}catch(t){return a.print.warn('Unable to parse data "'+e+'"'),{}}}(t);try{t.removeAttribute(r.DOM_DATA_COMPONENT_STATE_ATTR)}catch(t){a.print.warn('Unable to remove "'+r.DOM_DATA_COMPONENT_STATE_ATTR+'" attribute from node')}return e}function u(t,e){var n=function(t){var e=/^([\w\.]+)\s+as\s+(\w+)$/gm.exec(t);return null!==e?{name:e[1].trim(),alias:e[2].trim()}:{name:t.trim(),alias:null}}(e),r=n.name.split(o.COMPONENT_NS_DELIMITER),u=r[0],h=r.slice(1),d=l.getConfigCollapsed(n.name),p=i.getComponent(u);if(void 0===p)return a.print.warn("Component '"+u+"' was not found"),null;var m=c(t)[u]||{},f=s.deepMerge({},d.initialState,m.state),g=s.deepMerge({},d.options,m.options);return new p(h.join(o.COMPONENT_NS_DELIMITER),g,f).mount(t).dispatch(n.alias||u)}function h(t){var e=t.getAttribute(r.DOM_DATA_COMPONENT_NAME_ATTR);if(!e)return[];for(var n=[],s=0,i=e.split(o.COMPONENT_DELIMITER);s<i.length;s++){var a=u(t,i[s]);null!==a&&n.push(a)}return n}e.initComponents=h,e.initAllComponents=function(t){if(!t)throw new Error("$root element not found");var e=t.querySelectorAll(r.DOM_DATA_COMPONENT_SEL),n=Array.prototype.slice.call(e);t.getAttribute(r.DOM_DATA_COMPONENT_NAME_ATTR)&&n.unshift(t);for(var s=[],i=0,o=n;i<o.length;i++){var a=h(o[i]);s=s.concat(a)}return s}},17:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(4),i={};e.registerComponent=function(t){var e=t.registryName;if(!e){var n=function(t){return(t.toString().match(/function (\w*)/)||[])[1]}(t);throw new Error(s.format('Static property "registryName" is not defined for component "'+n+'"').error().str())}if(e in i)throw new Error(s.format("Component with name '"+e+"' is already registered").error().str());s.print.log('Registering "'+e+'"'),i[e]=t},e.getComponent=function(t){return i[t]}},18:function(t,e,n){"use strict";var s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(19),o={templatesExt:".xml.js",templatesPath:"/bem",templatesNS:"fest"},r=function(){function t(){this._store=new i.Store("MPF_GLOBAL",o,this.dispatchStore.bind(this)),this._store.dispatch()}return t.prototype.dispatchStore=function(){},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(t){this._store.put((function(e){return s({},e,t)})),this._store.dispatch()},t}();e.ApplicationSettings=r,e.applicationSettings=new r},187:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=function(){function t(t,e){t.removeClass(e),this._state.animated=!1,this._swipe.pause(!1)}function s(t,e){this._elems.sliding[t](e+"%")}function i(t){var n,i,o,r=!this._opts.isVertical,a=this._elems.parent,l=this.getOffset();r?(n="width",l=l.left):(n="height",l=l.top),i=a[n](),(o=Math.min((t-l)/i*100,100))==this._state.offset&&e.requestAnimationFrame(this.onAnimationEnd),this._state.offset=o,s.call(this,n,o)}function o(){this._elems.compareContent.css({width:"",height:""}),this._elems.parent.height(""),this._elems.sliding[this._opts.isVertical?"height":"width"]("")}function r(){o.call(this);for(var t,e,n,s=!this._opts.isVertical,i=this._elems.compareRegion.get(0).getBoundingClientRect(),r=this._elems.compareRegion.get(1).getBoundingClientRect(),a=this._elems.parent,l=["width","height"],c=0;c<l.length;c++)n=0===c,t=l[c],e=Math[n===s?"min":"max"](r[t],i[t],a[t]()),!n&&s?a[t](e):this._elems.compareContent[t](e)}function a(){var t=this._opts.isVertical?1:0;this._swipe=n.Tools.initModule("Swipe",this._elems.parent,{targetAxis:this._opts.isVertical?"y":"x",resetDelta:!0,_Handlers:{start:function(e,n){this._state.startFrom=n.from[t]}.bind(this),move:function(e){i.call(this,this._state.startFrom+e[t])}.bind(this),end:function(){this._state.startFrom=null,this._state.click=!1}.bind(this)}})}return{_Handlers:{dom:{"resize:window":function(){this.fixSizes()},click:function(t){if(!this._state.animated)if(this._state.click){var e=this._elems.compareRegion.eq(0),n=this._opts.cssClss.animated;n&&(e.addClass(n).one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.onAnimationEnd),this._swipe.pause(!0),this._state.animated=!0),i.call(this,function(t){return{x:t.pageX||t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.body.scrollTop+document.documentElement.scrollTop}}(t.originalEvent||t)[this._opts.isVertical?"y":"x"])}else this._state.click=!0}}},_Init:function(){var n=this._elems.compareRegion,s=this._opts.cssClss.animated;2!==n.length&&e.console.error("Wrong compare elems count"),s&&(this.onAnimationEnd=t.bind(this,n.eq(0),s)),this._state={animated:!1,startFrom:null,click:!0,offset:this._opts.startOffset};var i=n.find("img");i.length?Promise.all(i.toArray().map((function(t){return!0===t.complete?Promise.resolve():new Promise((function(e,n){t.onload=e,t.onerror=n}))}))).then(this.fixSizes.bind(this)):this.fixSizes.call(this),a.call(this)},getOffset:function(){var t=this._elems.parent.get(0).getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}},fixSizes:function(){r.call(this),s.call(this,this._opts.isVertical?"height":"width",this._state.offset)}}}(),o=s.getView(i,{cssSels:{Main:{slider:".js-compare__separator",compareRegion:".js-compare__item",compareContent:".js-compare__size",sliding:".js-compare__sliding"}},cssClss:{animated:"compare__item_animated"},startOffset:"50",isVertical:!1},null,"CompareSlider");n.Basic.moduleOpts.setParams("CompareSlider",{paramAttrs:{startOffset:"data-startfrom",isVertical:"data-vertical"}}),s.Extend(e.getNameSpace("Modules",n),{CompareSlider:o})}(window.jQuery||window.$,window,window.ru.mail.cpf)},19:function(t,e,n){"use strict";var s=Object.assign||function(t){for(var e,n=1,s=arguments.length;n<s;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};Object.defineProperty(e,"__esModule",{value:!0});var i=n(4),o=n(34),r=n(36),a={},l=new o.Emitter;new r.DevToolsExtension;function c(t){for(var e={},n={},s=0,i=Object.keys(t);s<i.length;s++){var o=i[s];"@"===o.charAt(0)?e[o]=t[o]:n[o]=t[o]}return{component:n,shared:e}}var u=function(){function t(t,e,n){this._id=t,this._events=[],this._EVENT_CHANGE="CHANGE:"+t,this._EVENT_INIT="INIT:"+t;var s=c(e).component;a[t]?i.print.warn("'"+t+"' is already connected"):(this.bind(n),a[t]=s,l.emit(this._EVENT_INIT,a[t]))}return t.hasEntity=function(t){return t in a},t.prototype.destroy=function(){var t=this;this._events.forEach((function(e){l.removeListener(t._EVENT_CHANGE,e)})),delete a[this._id]},t.prototype.dispatch=function(){l.emit(this._EVENT_CHANGE,a[this._id])},t.prototype.put=function(t){var e=this.read(),n=t(this.read()),s=c(e).component,i=c(n).component,o=Object.keys(s),r=Object.keys(i);0===o.length&&0===r.length||(a[this._id]=i,l.emit(this._EVENT_CHANGE,i,e))},t.prototype.read=function(){var t=a[this._id];return s({},t)},t.prototype.bind=function(t){this._events.push(t),l.on(this._EVENT_CHANGE,t)},t}();e.Store=u},198:function(t,e,n){n(52),n(51),n(199),n(53),n(200),n(54),n(201),n(202),n(57),n(203),n(55),n(59),n(60),n(204),n(56),n(58),n(61),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-viewbox-popup/ct-viewbox-popup.xml.js"),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-viewbox-previews/ct-viewbox-previews.xml.js"),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-viewbox-slides/ct-viewbox-slides.xml.js"),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-viewbox-more/ct-viewbox-more.xml.js"),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-viewbox-slide-content/ct-viewbox-slide-content.xml.js")},199:function(t,e){!function(t,e,n,s){"use strict";var i,o=n.Basic.Constructors.getView,r=n.Basic.Extend,a=n.Basic.moduleOpts.setParams;r(!0,n,{Modules:{GalleryControls:o((i=["prev","next"],{_Handlers:{"dom:click:Main.Controls":"_onControlClick",model:{lastimage:"_onLastImage",imagechange:"_onImageChange",message:"_onMessage"}},_Init:function(){null===this._elems.Controls&&s&&e.console.warn("GalleryControls: element 'Main.Controls' not found");var t=this._Model.getCurrentImage(),n=t.image,i=this._Model._opts.Loop,o=0===n,r=n===t.setLength-1;(!i&&null!==n||o&&r)&&(o||r)&&this._onLastImage(r,o)},toggle:function(t){t=t||{};var e=this._elems.Controls;if(e){var n=this._opts,s=n.cssClss.disabledControl,i=n.Attrs.switchDirection;s&&e.each((function(e,n){var o=n.getAttribute(i)||"";"boolean"==typeof t[o]&&n.classList[t[o]?"remove":"add"](s)}))}},_onControlClick:function(t){var e=this._Model,n=t.currentTarget.getAttribute(this._opts.Attrs.switchDirection)===i[1],s=e.getCurrentImage(),o=s.image;null===s.set&&e.changeSet(0),null===o&&(o=0,e.changeImage(o)),e.changeImage(o+(n?1:-1)),t.preventDefault()},_onLastImage:function(t,e){this.toggle({prev:t&&!e,next:e&&!t})},_onMessage:function(t){if("controls"===t.name){var e=t.value||{};"boolean"==typeof e.disable&&this.toggle(e.disable?{prev:!1,next:!1}:{prev:!0,next:!0})}},_onImageChange:function(){this.toggle({prev:!0,next:!0})}}),{cssSels:{Main:{Controls:null}},cssClss:{disabledControl:null},Attrs:{switchDirection:"data-direction"}},null,"GalleryControls")}}),a("GalleryControls",{acceptTypes:["Gallery"]})}(window.jQuery||window.$,window,window.ru.mail.cpf,window.DEBUG)},20:function(t,e,n){"use strict";var s,i=(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(39),r=n(40),a=n(21),l=n(4),c=n(5),u=n(10);e.DOMEvent=function(t){return function(t,e,n){}},e.DOMBind=function(t,e,n){};var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._events={},e}return i(e,t),Object.defineProperty(e.prototype,"$",{get:function(){if(!this._$root)throw new Error(l.format('Component "'+this.identity+'" not mounted').error().str());return this._$root},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"$elements",{get:function(){return this._collector.group(this.$,this.alias)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){null!==this._unbindEvents&&(this._unbindEvents(),this._unbindEvents=null),t.prototype.reset.call(this)},e.prototype.getElements=function(t){return this._collector.elements(this.$,t,this.alias)},e.prototype.mount=function(t){return this._$root||(this._$root=t),this},e.prototype.preDispatch=function(){var t,e=this;this._collector=new a.Collector((t=this.alias,"["+u.DOM_DATA_COMPONENT_EL_ATTR+'*="'+t+c.COMPONENT_EL_DELIMITER+'"]'),u.DOM_DATA_COMPONENT_EL_ATTR);var n=r.eventsBinder(this.$,(function(t){return e._collector.elements(e.$,t,e.alias)}));this._unbindEvents=n(this._events),r.dataBinder(function(t){return"["+u.DOM_DATA_COMPONENT_BIND_ATTR+'*="'+t+c.COMPONENT_DATA_BIND_DEF_DELIMITER+'"]'}(this.alias),u.DOM_DATA_COMPONENT_BIND_ATTR)(this,this._store.bind.bind(this._store),this.getState.bind(this))},e.prototype.postDispatch=function(){l.print.groups("Component ("+this.identity+")",{$:[this.$,this.$elements],options:[this.options],state:[this.getState()]})},e}(o.Component);e.DOMComponent=h},200:function(t,e){!function(t,e,n){var s=n.Basic,i=n.Modules,o="WritableGalleryPreviews",r=s.Constructors.getView(function(){function t(t){var e,n,s=this._previewsVersion,i=[];if(!isNaN(s)&&null!==s)for(var o=0;o<t.length;o++)n=null,(e=t[o].versions[s])?n=e.src:!0===this._opts.ignoreVersionMiss&&(n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"),n&&i.push(n);return i}function n(n){var s=t.call(this,n),i=e.document.createElement("div");return i.innerHTML=this._opts.Templates.previews({previews:s,current:this._Model.getCurrentImage().image}),i.childNodes}function s(){var t=this._Model._getSetImages(this._imagesSet),e=this._elems,s=e.previewsCont;t&&t.length>1&&(s.html(n.call(this,t)),e.Preview=s.find(this._opts.cssSels.Main.Preview))}return{_Handlers:{model:{setchange:"_onSetChange"}},_Init:function(){var t=this._opts,e=t.imagesSet;if(this._imagesSet=e=null===e?e:1*e,this._drawnSet=e||this._Model.getCurrentImage().set,this._previewsVersion=1*t.previewsVersion,isNaN(this._imagesSet))throw new TypeError('Wrong type of "imagesSet" option');s.call(this)},_onSetChange:function(t,e){var n=this._imagesSet;(null===n&&this._drawnSet!==e||n===e)&&(this._drawnSet=e,s.call(this))}}}(),{cssSels:{Main:{previewsCont:null}},previewsVersion:2,ignoreVersionMiss:!1,Templates:{previews:null}},i.GalleryPreviews,o);i[o]=r,s.moduleOpts.setParams(o,{acceptTypes:"Gallery"})}(window.jQuery,window,window.ru.mail.cpf)},201:function(t,e){var n;window.jQuery,window,(n=window.ru.mail.cpf).Basic.Constructors.addPlugin("PopupGalleryView",{_initPopup:function(){return n.Tools.initModule(["GalleryControls",this._opts.controlsExt],this._elems.parent,null,null,[{type:"Gallery",instance:this._model}]),this._super.apply(this,arguments)}},{controlsExt:"PopupGalleryView"},"Controls")},202:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.Constructors.addPlugin,i=n.Basic.debounce,o=n.Tools.initModule;s("PopupGalleryView",function(){function t(){var t=this._model.getCurrentImage().setLength>1&&this._previews&&this._previews._Elems.Preview.length>0;this._opts.cssClss.hasPreviews?this._elems.parent.toggleClass(this._opts.cssClss.hasPreviews,t):this._elems.previewsCont.toggle(t)}function e(){var t=this._Elems.previewsCont,e=this._model.getCurrentImage(),n=this._previewsSlider;if(!n&&e.setLength>1&&t&&t.length&&(this._previews=o(["WritableGalleryPreviews",this._opts.previewExt],t,null,null,[{instance:this._model,type:"Gallery"}]),n=this._previewsSlider=o(["Slider",this._opts.previewSliderExt],t))){var s=i(n.update.bind(n,!0,!1,!0),500);s(),n.getFrames().find("img").each((function(){this.complete||(this.onload=s)}))}}return{_Handlers:{model:{imagechange:function(t,e,n){var s=this._previewsSlider;this._isTargetImage(n)&&!this._setChanged&&s&&s.goToFrame(e,!this._state.visible)},setchange:function(n){this._isTargetImage(n)&&null!==this._Popup&&(this._previewsSlider?this._previewsSlider.update():e.call(this),t.call(this),this._setChanged=!0)}}},_initPopup:function(){return e.call(this),t.call(this),this._super.apply(this,arguments)},_showImageVersion:function(){this._super.apply(this,arguments),this._setChanged=!1},_processViewSizes:function(){var t=this._previewsSlider;this._super.apply(this,arguments),t&&t.update()}}}(),{cssSels:{Main:{previewsCont:null}},cssClss:{hasPreviews:null},previewSliderExt:"PopupGalleryViewPreviews",previewExt:"PopupGalleryView"},"SliderPreviews")}(window.jQuery,window,window.ru.mail.cpf)},203:function(t,e){!function(t,e,n){var s=n.Basic;s.Constructors.addPlugin("PopupGalleryView",function(){function t(t){var n,i,o,r=this._shareButtons,a=this._opts.viewShares;r&&(n=t[a.urlProp],(i=(o=s.typeOf(n,"string")&&n.length>0)||!0!==a.hideWhenNoUrl)&&(n=o?n:e.location.href,r.updateElementsSet(this._getViewParent()||this._elems.sharesCont),r.setUrl2Share(n,{Title:t.title||t.description},!1)),this._opts.cssClss.hideShares?this._elems.sharesCont.toggleClass(this._opts.cssClss.hideShares,!i):this._elems.sharesCont.toggle(i))}return{_Handlers:{model:{imageready:function(e,n,s,i){this._isTargetImage(s,i)&&this._state.visible&&t.call(this,e)}},show:function(){t.call(this,this._model.getImageProps())}},_initPopup:function(){var t=this._elems.sharesCont;return t&&t.length&&(this._shareButtons=n.Tools.initModule(["Shares",this._opts.sharesExt],t,{getCntOnInit:!1})),this._super.apply(this,arguments)}}}(),{cssSels:{Main:{sharesCont:null}},cssClss:{hideShares:"hidden"},sharesExt:"PopupGalleryView",viewShares:{urlProp:"share_url",hideWhenNoUrl:!0}},"Shares")}(window.jQuery,window,window.ru.mail.cpf)},204:function(t,e){var n,s,i,o;n=window.jQuery||window.$,window,s=window.ru.mail.cpf,i=s.Basic,o=s.Tools.Images,(0,i.Constructors.addPlugin)("ImageView",(o._addTypes({iframe:{exts:["html"],canPreload:!1}}),{_setImageToView:function(t,e,s){var i,o=this._opts;return s=this._super.apply(this,arguments),"iframe"===t.type&&((i=this._Model.getFromCache(t.src))||(i=n("<iframe />").attr(o.frameParams).attr("src",t.src),this._Model.addToCache(i,t.src)),i.css(e).appendTo(s)),s}}),{frameParams:{scrolling:"no",frameborder:0}},"Iframe")},205:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams,i=n.Basic.Constructors._repo.get("Gallery");s("Gallery",{options:{imageProps:["original","download","share_url","description","title","galleryId","product"],preloadDepth:2}}),s("Gallery.CatalogModel",{initializer:function(t,e,n,s){var o=new i(t,s);return setTimeout((function(){o.changeSet(0)}),0),o},options:{_plugins:{}}})}(window.jQuery,window,window.ru.mail.cpf)},206:function(t,e){!function(t){"use strict";var e=t.Basic.moduleOpts.setParams,n=t.Basic.Constructors._repo.get("GalleryPreviews");e("GalleryPreviews",{acceptTypes:["Gallery"],initializer:function(e,s,i,o){return o&&"images"in o&&(e.imagesSet=i.addImagesSet(t.Basic.Extend(!0,{},o))),new n(e,s,i)},options:{cssSels:{Main:{Preview:".js-preview-list__item"}},cssClss:{currentPreview:"cols__column_thumb_active"},Attrs:{imageVersions:["data-original","data-preview"],imageProps:{description:"data-descr",title:"data-title"}}}})}(window.ru.mail.cpf)},207:function(t,e){!function(t,e){"use strict";var n=e.Basic.Constructors.getView,s=e.Basic.moduleOpts.setParams;n({_Init:function(){var t=this._Elems.Parent.data("PopupGalleryView"),e=this._Opts.backUrl,n=parseInt(this._Opts.currentImg),s=this._Opts.currentSet;t&&e&&t.on("hide",(function(){setTimeout((function(){history.replaceState(null,null,e)}),200)})),isNaN(n)||setTimeout(function(){this._Model.changeSet(parseInt(s,10)||0),this._Model.changeImage(parseInt(n,10))}.bind(this),10)}},{currentImg:null,currentSet:null,backUrl:null},null,"GalleryShot"),s("GalleryShot",{acceptTypes:"Gallery",paramAttrs:{currentImg:"data-photo-id",currentSet:"data-set-id",backUrl:"data-return-url"}})}(window,window.ru.mail.cpf)},208:function(t,e){!function(t,e,n){"use strict";var s,i,o=n.Tools.initModules,r=n.Basic.moduleOpts.setParams;function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"d";isNaN(parseInt(t))||((new Image).src="//rs.mail.ru/".concat(e).concat(t,".gif?r=").concat(Math.round(1e11*Math.random())))}r("PopupGalleryView",{options:{cssSels:{Main:{imageView:".js-photo",imageNum:".js-photo_num",imagesTotal:".js-photos_cnt",previewsCont:".js-photo_slider",sizeCont:".js-photo_container",sharesCont:".js-photo_shares"},sizeReference:".js-size-reference",setProps:{title:".js-photo_title",note:".js-photo_note"}},cssClss:{Loading:"viewbox__slide_loading",Error:"viewbox__slide_error",hasPreviews:"viewbox_list",hideShares:"viewbox__slides_hide-shares"},templates:{block:n.Tools.getTemplate("ct-viewbox-popup.xml"),frames:n.Tools.getTemplate("ct-viewbox-slides.xml"),splash:n.Tools.getTemplate("ct-viewbox-more.xml")},showBanner:!0,splashBannerParams:{slotId:"586902?_SITEID=123"},setContSize:!1,imagesSet:null,imagesVersion:0,resizeView:!0,_Handlers:{model:{splash:function(){o(t(this._elems.parent))},imageready:(s=n.Tools.Counters.hitCntrsBlck,i=[],function(t,n,o,r){if(t&&this._isTargetImage(o,r)&&this._Model.getCurrentImage().image===n&&this._state.visible){var a={url:e.location.origin+t.share_url};if(t.galleryId){if(-1===i.indexOf(t.galleryId))return void(i=i.concat([t.galleryId]));a.url=e.location.origin+"/virtual_gallery/"+t.galleryId}s(a)}}),imagechange:function(t){var n=e.showcase||{};if(t.product&&n.segment)switch(n.segment){case 1:a(68060627);break;case 2:a(68060625);break;case 3:a(68060624)}}}}}}),r("PopupGalleryView.CatalogModel",{options:{showOnChange:!1}}),r("PopupGalleryView.Timeline",{options:{_plugins:{Controls:!0,Shares:!0,ImageViewSlider:!0,PopupImageSlider:!0,SliderPreviews:!0}}}),r("PopupGalleryView.Article",{options:{showOnChange:!0,_plugins:{Controls:!0,UrlReplace:!0,ImageViewSlider:!0,PopupImageSlider:!0,SliderPreviews:!0,Splash:!0,SplashBanner:!0,Shares:!0,ImageViewSliderSplash:!0}}}),r("PopupGalleryView.Article.Nat",{options:{bannerExt:"PopupGalleryView.Nat"}}),r("PopupGalleryView.Card",{options:{_plugins:{Controls:!0,Shares:!0,ImageViewSlider:!0,PopupImageSlider:!0,SliderPreviews:!0}}}),r("PopupGalleryView.Infographics",{options:{showOnChange:!0,sizeLimits:{height:1/0}}}),r("WritableGalleryPreviews.PopupGalleryView",{options:{previewsVersion:1,Templates:{previews:n.Tools.getTemplate("ct-viewbox-previews.xml")},cssSels:{Main:{previewsCont:".js-photo_slider_cont",Preview:".js-photo_preview"}},cssClss:{currentPreview:"viewbox__preview_active"}}}),r("Swipe.ImageViewSlider",{options:{}})}(window.jQuery,window,window.ru.mail.cpf)},209:function(t,e){!function(t,e,n){"use strict";(0,n.Basic.moduleOpts.setParams)("ImageView.CatalogModel",{acceptTypes:["Gallery"],options:{_plugins:null,cssSels:{Main:{imageView:".js-imageview",imageNum:".js-gallery__count__current",imagesTotal:".js-gallery__count__total"}}}})}(window.jQuery,window,window.ru.mail.cpf)},21:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),i=function(){function t(t,e){this.elSel=t,this.attrSel=e}return t.prototype.getName=function(t,e){var n=t.getAttribute(this.attrSel);return"string"==typeof n&&e?n.replace(""+e+s.COMPONENT_EL_DELIMITER,""):n},t.prototype.group=function(t,e){for(var n={},s=t.querySelectorAll(this.elSel),i=0,o=Array.prototype.slice.call(s);i<o.length;i++){var r=o[i],a=this.getName(r,e);null!==a&&(n[a]||(n[a]=[]),n[a]=n[a].concat(r))}return n},t.prototype.elements=function(t,e,n){var s=this,i=t.querySelectorAll(this.elSel);return Array.prototype.slice.call(i).filter((function(t){return s.getName(t,n)===e}))},t}();e.Collector=i},210:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams;s("GalleryControls.PopupGalleryView",{options:{cssSels:{Main:{Controls:".js-photo_ctrl"}},cssClss:{disabledControl:"hidden_all"}}}),s("GalleryControls.CatalogModel",{acceptTypes:["Gallery"],options:{cssSels:{Main:{Controls:".js-gallery__controll"}},cssClss:{disabledControl:""}}})}(window.jQuery,window,window.ru.mail.cpf)},211:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.typeOf,i=n.Basic.Extend,o=n.Basic.throttle,r=n.Basic.Constructors.getModel,a=n.Basic.moduleOpts.setParams,l=n.Types.String.Url.addParams,c=n.Tools.transport,u={transport:function(){return c.apply(null,arguments)},baseApiUrl:"//ad.mail.ru/adp/"},h=r(function(){function n(t){var e="";return-1!=t.indexOf("\x3c!--slotLoaded--\x3e")&&(this.loaded=!0,this.contents=e=t),e}function r(t){var e="";return s(t,"array")&&t.length&&(this.loaded=!0,this.contents=e=t[0].html),e}function a(t){var e,s,i,o=this._banners[t];return o?(o.loadPromise?s=o.loadPromise:(i="rb"===o.dataType?"jsonp":"text",e=function(t){return delete o.loadPromise,t},o.loadPromise=s=this._opts.transport({url:o.url,type:"GET",dataType:i,data:o.params||{}}).then((function(){var t="text"===i?n:r;return o.rendered=!1,t.apply(o,arguments)})),s.then(c.bind(this,t)).then(e,e)),s):Promise.reject()}function c(t){var e=this._hitTimers,n=this._banners[t].hitTimeout,s=!1;return isNaN(n)?e[t]=null:n<=0?(e[t]=!0,s=!0):(e[t]=setTimeout((function(){e[t]=null}),n),s=!0),s}function u(){this._banners.forEach((function(t){t.hasPlace=null}))}return{_Init:function(){this._banners=[],this._hitTimers={},t(e).on("resize",o(u,100,this))},add:function(t,n){var o,r,c,u=this._opts;if(s(t,"string"))r=t;else{if(!s(t,"object"))return;(c=t.query||t.id)&&(r=u.baseApiUrl+"?q="+encodeURIComponent(c),e.rb_innerhtml=1),t.params&&(r=l(t.params||{},r,{replace:!0}))}return t=i({},t,{url:r,contents:null}),o=this._banners.push(t)-1,s(t.hasPlaceForBanner,"function")||(t.hasPlaceForBanner=this.hasPlaceForBanner.bind(this)),!1!==n&&a.call(this,o),o},get:function(t){var e,n=this._banners[t];return n&&(e=n.contents,n.contents=null),e},reload:function(t){var e=this.get(t);return this.preload(t),e},canReload:function(t){var e=this._hitTimers[t];return!0!==e&&(null===e||s(e,"undefined"))},preload:a,check:function(t){var e=this._banners[t],n=!1;return e&&((n=!!e.contents)||this.preload(t)),n},drawTo:function(n,s,i){var o,r,a=this._banners[n];if(a)return(o=t(e.document.createElement("iframe"))).attr("scrolling","no"),Array.isArray(i)&&2===i.length&&o.css({width:i[0],height:i[1]}),o.attr("src","about:blank"),s.children().detach(),o.appendTo(s),(r=o.contents().get(0)).write(this.get(n)),r.close(),a.rendered=!0,o},hasPlaceForBanner:function(e,n,s){var i=n[s?0:1],o=s?"width":"height",r=s?"offsetLeft":"offsetTop";return e[o]()-Math.max.apply(Math,e.children().toArray().map((function(e){return e[r]+t(e)[o]()})))>=i},showBanner:function(t,e){var n,i=this._banners[e],o=i&&i.container,r=!1;return o?(s(o,"string")&&((o=t.data("_bannerCont_"+e))||(o=t.find(i.container),t.data("_bannerCont_"+e,o))),o.length&&(n=i.hasPlaceForBanner(t,i.sizes,i.horizontal))&&(i.loaded?(i.rendered||this.drawTo(e,o,i.sizes),this.canReload(e)&&a.call(this,e),r=!0):(this.preload(e),r=!1)),r&&(s(n,"boolean")?n:r)):r}}}(),u,null,"BannerController")();a("BannerController",{initializer:function(){return h}}),i(!0,n,{Instances:{bnnrCtrl:h}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},212:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.Extend,o=s.typeOf,r={},a={cssSels:{Main:{container:".js-popup_banner"}},cssClss:{show:"viewbox__slide_side_show",loading:"viewbox__slide_side_loading",loadFail:""},bannerParams:{},bannerModuleName:"Slot",hasPlaceForBanner:l,minReloadDelay:1e3,showOnInit:!1,reloadOnRerun:!0,continuousMode:!0};function l(){return!0}var c=function(){var t={};function e(){for(var t="",e=0;e<3;e++)t+=Math.round(1e10*Math.random()).toString(36);return t}return function(){for(var n=e();t[n];)n=e();return t[n]=!0,n}}();var u=function(t){var e,n=this._opts.cssClss,s=!0,i="";if(this._state.stateName!==t){switch(t){case"load":e="loading",i=n.loading;break;case"show":e="show",i=n.show;break;case"fail":e="loadFail",i=n.loadFail;break;case"hide":e="hide";break;default:s=!1}s&&(this._state.stateName=t,this._elems.parent.removeClass([n.show,n.loading,n.loadFail].join(" ")).addClass(i),this._trigger(e,{type:e}))}},h=function(){var t=this._state,e=t.loadPromise;return u.call(this,"load"),e||(e=n.Tools.loadSlot(p.call(this)).then((function(){t.loaded=!0})),m.call(this)),e},d=function(){var t=this.once;return new Promise((function(e,n){t("show",e),t("loadFail",n)}))},p=function(){var t,e,s,o,r=this._opts,a=(t=r.bannerModuleName,s=t.split("."),o="",s.forEach((function(t){t=o+t,e=i(!0,e||{},n.Basic.moduleOpts.get(t)),o=t+"."})),e),l=r.bannerParams,c=i({},a.slot,l.slot),u=c.params||{};return{slot:l.id,failTimeout:a.failTimeout,blockSel:"#"+this._state.id,slotParams:{sz:c.sitezone||"",region:c.region||"",siteId:c.siteId||"",params:u},mimic:a.mimic,afterRenderPromise:d.bind(this)}},m=function(){var t=this._state,e=r[t.cacheId];e||(e={timeout:null,canReload:!0},r[t.cacheId]=e),e.timeout&&clearTimeout(e.timeout),e.canReload=!1,e.timeout=setTimeout((function(){e.canReload=!0}),this._opts.minReloadDelay)};var f=s.Constructors.getView({_Events:["show","hide","loadFail","loading"],_Init:function(){var t=this._opts,e={loaded:!1,canReload:!0,id:c()};t.continuousMode&&(e.cacheId=function(t){if(o(t,"string"))return t;var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=t[n]);return e}(t.bannerParams)),this._state=e,this._elems.container.prop("id",e.id),t.showOnInit&&this.show()},show:function(){if(this.canShow()){var t=u.bind(this),e=this._state;e.loaded?this._opts.reloadOnRerun?this.reload():t("show"):h.call(this).then((function(){t(e.loaded?"show":"hide")}),(function(){t("fail")}))}else this._opts.reloadOnRerun&&this.hide()},reload:function(){var t=this._state;t.loaded=!1,t.loadPromise=null,this.hide(),this.show()},hide:function(){u.call(this,"hide")},clear:function(){this._elems.container.children().detach()},canShow:function(){return!!this.hasPlaceForBanner()&&(!!this._state.loaded||(!this._opts.continuousMode||this.canReload()))},canReload:function(){return!this._opts.continuousMode||(!r[this._state.cacheId]||r[this._state.cacheId].canReload)},hasPlaceForBanner:function(){var t=this._opts.hasPlaceForBanner;return o(t,"function")||(t=l),t.call(this)}},a,null,"Banner");e.getNameSpace("Modules",n).Banner=f}(window.jQuery,window,window.ru.mail.cpf)},213:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams,i=document.querySelector(".js-article"),o=0,r={};i&&(o=i.getAttribute("data-slot-id")||0,r={_STRING:i.getAttribute("data-slot-string")}),s("Banner.PopupGalleryView",{options:{reloadOnRerun:!0,continuousMode:!0,minReloadDelay:1e3,bannerParams:{id:"378475",dataType:"rb"},bannerModuleName:"SlotView.mimic.378475.Overlay",hasPlaceForBanner:function(){return!0}}}),s("Banner.PopupGalleryView.Nat",{options:{bannerParams:{id:o,dataType:"rb",slot:{params:r}},bannerModuleName:"SlotView.CommercialOverlay.".concat(o)}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},214:function(t,e,n){n(215),n(216)},215:function(t,e,n){!function(t,e,n){"use strict";var s=n.Tools.initModules,i={cssSels:{Main:{container:".js-async-render__content"}},url:null,immediate:!0,template:null,prepareTemplateData:null,transport:n.Tools.transport};n.Basic.Constructors.getView({_Events:["render"],_Init:function(t){t=t||{};var e=this._opts;if(e.template&&(this._state={inited:!1,templateDate:t},e.immediate)){var s=e.url,i=Promise.resolve();s&&(i=e.transport({url:s})),i.then(function(t){t&&(this._state=n.Basic.Extend(this._state,{templateDate:t})),this.render()}.bind(this))}},render:function(){var e=this._opts,n=this._state;if(!n.inited){var i=this._elems.container||this._elems.parent,o=n.templateDate;e.template,"function"==typeof e.prepareTemplateData&&(o=e.prepareResponse.call(this,o)),e.template.asyncRender(o).then(function(e){var n=t(e);i.html(n),s(n),this._trigger("render")}.bind(this))}}},i,null,"AsyncRender")}(window.jQuery||window.$,window,window.ru.mail.cpf)},216:function(t,e){!function(t,e,n){"use strict";(0,n.Basic.moduleOpts.setParams)("AsyncRender.Slider",{options:{template:(0,n.Tools.getTemplate)("ct-slider.xml")},paramAttrs:{url:"data-models-url"}})}(window.jQuery,window,window.ru.mail.cpf)},217:function(t,e){!function(t,e,n){"use strict";var s=n.Tools.PubSub,i=n.Basic.moduleOpts.setParams;i("Toggle",{options:{animate:!0}}),i("Toggle.CatalogSearch",{options:{cssSels:{preventToggle:".js-tooltip__description-button"},cssClss:{hidden:"block_collapse_height"},animate:!1,_Handlers:{toggle:function(){this._elems.button.find(".icon_svg")[0].classList.toggle("icon_rotate")}}}}),i("Toggle.CatalogSearchCut",{options:{cssSels:{Main:{block:".js-toggle",button:".js-toggle-inner__button",container:".js-toggle-inner__container"},button:".js-toggle-inner__button",scrollingBlock:".js-scrollable"},cssClss:{hidden:"hidden",expand:"p-scroll_expand"},animate:!1,hideButton:!0,_Handlers:{toggle:function(){if(this._state.shown){var t=this._opts,e=t.cssClss,s=this._elems.block.find(t.cssSels.scrollingBlock);s.addClass(e.expand),n.Tools.initModules(s)}}}}}),i("Toggle.ModelParameters",{options:{_Handlers:{toggle:function(){s.publish("reviewlist.specs.toggle")}},animate:!1,hideButton:!0,cssClss:{hidden:"hidden"}}}),i("Toggle.Diafilm",{options:{_Handlers:{toggle:function(){s.publish("filmstrip.mail.form.show")}}}}),i("Toggle.Features",{options:{_Handlers:{toggle:function(){var t=this._state;this._elems.button.find(this._opts.cssSels.buttonText).text(t.shown?"Показать все":"Скрыть"),s.publish("reviewlist.specs.toggle")}},animate:!1,hideButton:!1,cssSels:{buttonText:".js-toggle__button-text"},cssClss:{hidden:"toggle__item_active"}}}),i("Toggle.TimelineComments",{options:{cssSels:{Main:{toggleText:".js-toggle__button-text"}},cssClss:{hidden:"toggle_active"},toggleParent:!0,animate:!1,_Handlers:{buttonClick:function(){var t;t=document.querySelector("#vk_comments_translation"),e.VK.Widgets.Comments&&!t.innerHTML&&e.VK.Widgets.Comments("vk_comments_translation",{limit:20,attach:"*",height:400,width:350},"timeline")},toggle:function(){var t=this._elems.toggleText,e=this._state.shown;t.html(e?"Обсудить":"Скрыть обсуждение")}}}}),i("Toggle.Spoiler",{options:{_Handlers:{toggle:function(){var t=this._state,e=this._elems,n=this._opts.cssClss.buttonToggle;e.button.toggleClass(n,!t.shown)}},cssClss:{hidden:"toggle_active",buttonToggle:"hidden"},animate:!1,toggleParent:!0}})}(window.jQuery,window,window.ru.mail.cpf)},218:function(t,e){!function(t,e,n){"use strict";function s(){var e=n.Basic,s=n.Tools,i=e.Extend,o=n.Instances.Ago,r=e.Constructors._repo.get("Popup"),a=s.getTemplate,l={comment:a("ct-comment.xml"),alert:a("ct-popup-alert.xml")},c=n.Comp.jQuery.Comments,u=t(".js-comments");if(0!==u.length){var h,d=n.Tools.initModules,p=n.Basic.getOptions(u[0]),m=p.currentPage,f=p.totalPages,g=p.topicId,_=p.commentsCount,v=!!p.handleScroll;h=c.prepareComments({complainOpts:{forumParams:{topicId:g},reqUrl:p.complainUrl},useContainer:!1,deleteUrl:p.deleteUrl,adminUrl:p.adminUrl});var w=c.commentsManager({cssSels:{errorDescr:".js-alert__text_1"},onPageChange:function(){o&&o.update()},urlParams:{postUrl:p.postUrl,commentsUrl:p.commentsUrl+"?",historyUrl:p.historyUrl+"?",topicParam:"tid",commentParam:"rid",lastParam:null,replyToComment:"reply-",targetComment:"comment-"},commentsPerPage:p.perPage,currentPage:m,totalPages:f,topicId:g,texts:p.texts,preparePageResponse:h.preparePageResponse,prepareHistoryResponse:h.prepareHistoryResponse,preparePostCommentResponse:h.preparePostCommentResponse,useNewApi:!0,transport:function(t){return t.csrf=!0,t.type="POST",s.transport(t)}});w.bind("errorsend",(function(t){t.data&&"is_banned"===t.data.err_code&&y.call(this,"Вы не можете размещать сообщения","Вы ограничены в правах на публикацию комментариев.Это произошло по причине того, что вы не соблюдали правила.<br><br>Давайте общаться прилично — уважайте себя и окружающих!")}));var b={cssSels:{Main:{textarea:"textarea"},form:"form",rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{sending:"button_disabled",formFixed:v?"comment-form_state_fixed":null,formShort:v?"comment-form_state_short":null},handleScroll:v,commentsCount:_,scrollCorrection:0};t(".js-comments_add").commentForm(w,b),t(".js-comments_add_timeline").commentForm(w,i(!0,b,{cssClss:{formShort:"comment-form_state_short"}})),u.commentsList(w,{cssSels:{rulesPopup:"#box-comment-rules",rulesLink:".some-never-exists-class"},cssClss:{active:"comment_active",showHistory:"comment_tree",showParent:"comment_parent",showForm:"comment_form",authorized:"comments_authorized"},prepareComments:function(t){h.prepareComments.apply(this,arguments),d(t),t.length&&o&&o.update({future:"только что",elems:t.get()})},commentTemplate:l.comment,commentIdPrefix:"comment-",commentsCount:_,currentPage:m,handleScroll:v,scrollDeltaTop:-75,useNewApi:!0,appendNewComment:p.appendNewComment||!1}),t(".js-comments_paging").commentsPaging(w,{currentPage:m,totalPages:f,cssClss:{disabledEndBtn:"comments-paging__end_disabled",disabledStepBtn:"comments-paging__nav_disabled",activePage:"comments-paging__item_active",fixed:"comments-paging_fixed"},button:{tagName:"a",className:"comments-paging__item",title:"Страница "},parentSizeProp:"paddingTop"}),w.reportEvent("statechange",{winHeightDelta:0})}function y(e,n){var s=l.alert;s&&n&&Promise.resolve(s).then(function(){var i=t(s({title:e,text:n}));this._alertPopup=new r(null,i),this._alertPopup.show()}.bind(this))}}s(),n.Tools.PubSub.subscribe("timeline.comments.show",s)}(window.jQuery||window.$,window,window.ru.mail.cpf)},219:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams,i=n.Tools.PubSub,o=n.Tools.triggerResize;s("AnchorMenu",{options:{attributes:{anchorName:"id"},cssClss:{itemActive:""}}}),s("AnchorMenu.Article",{options:{offsetTop:55,cssClss:{itemActive:"bar__item_active"}}}),s("AnchorMenu.Article.DigestNews",{options:{canUpdatePageUrl:!1}}),s("AnchorMenu.CatalogModel",{options:{offsetTop:55,cssSels:{outerItem:".js-outer-item"},cssClss:{itemActive:"bar__item_active"},_Handlers:{dom:{"click:outerItem":function(t){t.preventDefault();var e,n=/[^#]+$/.exec(t.currentTarget.href);n&&(e=this.getItem(n[0]))&&e.menuItem.trigger("click")}}}}}),s("AnchorMenu.Card",{options:{attributes:{anchorName:"name"},cssClss:{itemActive:"reference-page__menu-item_active"}}}),s("AnchorMenu.Timeline",{options:{_Handlers:{itemChoose:function(){i.publish("translation.last-posts.choose")},pubsub:{"translation.last-posts.update":function(){o()}}},cssClss:{itemActive:""},offsetTop:20,attributes:{anchorName:"id"}}})}(window,window.jQuery,window.ru.mail.cpf)},22:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(31);e.init=s.init;var i=n(11);e.setConfig=i.setConfig;var o=n(17);e.registerComponent=o.registerComponent;var r=n(16);e.initAllComponents=r.initAllComponents,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(38))},220:function(t,e){!function(t,e){"use strict";var n=e.Basic.moduleOpts.setParams;n("Notification",{options:{cssSels:{Main:{Head:".js-alert__head",Message:".js-alert__text_0"}}}}),n("Notify",{options:{blockSel:"#box-alert"}})}(window,window.ru.mail.cpf)},239:function(t,e,n){!function(t,e,n){"use strict";var s,i=n.Basic.Extend,o=t("head")[0],r=t(e),a=[],l=!1,c={loadTimeout:5e3,closestParent:null,checkRawItems:(s=function(t){var n,s,i=(n="webaudio",!(s=e.Modernizr)||"boolean"!=typeof s[n]||s[n]);return i||t.parentNode.removeChild(t),i},{soundcloud:s,rutube:s})},u={instagram:function(t){e.instgrm&&e.instgrm.Embeds&&e.instgrm.Embeds.process(t)},facebook:function(t){e.FB&&e.FB.XFBML&&e.FB.XFBML.parse(t)},twitter:function(t){e.twttr&&e.twttr.widgets&&e.twttr.widgets.load(t)}},h={various:function(){return!0}};function d(t){if(t&&t.length){var n=r.trigger.bind(r,"resize");t.forEach((function(t){t in u&&u[t]()})),e.requestAnimationFrame(n),setTimeout(n,2e3)}}function p(t){return!(!t||!t.length)&&(!!t.is("iframe")||!!t.find("iframe").length)}e.getNameSpace("Tools",n,!0).activateEmbeds=function(s,r){var m;l||((m=n.Basic.moduleOpts.get("ActivateEmbeds")||{}).initializers&&(u=n.Basic.Extend(u,m.initializers)),l=!0);var f=[],g=[],_=i(!0,{},c,r||{}),v=_.checkRawItems||{};return s.each((function(n,s){var i=s.getAttribute("data-type");if(!v[i]||!1!==v[i](s,i)){var r=t(),l=s.value.replace(/__text_area__/g,"textarea"),c=t(s),u=[];t(l).each((function(e,n){var s;"SCRIPT"===n.tagName?n.src?function(t){var e;t=t.split("?")[0],-1===a.indexOf(t)&&(a.push(t),(e=document.createElement("script")).type="text/javascript",e.setAttribute("defer","defer"),e.src=t+"?"+(Math.random()+"").split(".")[1],o.appendChild(e))}(n.src):((s=document.createElement("script")).type="text/javascript","textContent"in s?s.textContent=n.textContent:s=['<script type="text/javascript">',t(n).html(),"<\/script>"].join(""),u.push(s)):r=r.add(n)})),-1===f.indexOf(i)&&f.push(i),g.push(function(e,n,s){return new Promise((function(i,o){var r=s.closestParent?e.closest(s.closestParent):t(e.get(0).parentNode);setTimeout((function(){var t=h[n]||p,e={element:r.get(0),type:n};t(r)?i(e):o(e)}),s.loadTimeout)}))}(c,i,_).catch((function(t){0}))),c.replaceWith(r),u.length&&u.forEach((function(t){document.head.appendChild(t)})),e.requestAnimationFrame(r.trigger.bind(r,"documentHeightChange"))}})),e.requestAnimationFrame(d.bind(this,f)),g}}(window.jQuery||window.$,window,window.ru.mail.cpf)},240:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.throttle,o=n.Tools.activateEmbeds,r=t(e),a=/iphone|ipod/i.test(navigator.userAgent),l="touchend",c="scroll",u=function(){if(t(this._Elems.Parent).is(":visible")){var e,n=this._state.winSizes.height+this._opts.scrollLimit;this._state.items.forEach((function(s){s.getBoundingClientRect().top<n&&(e=(e||t()).add(s))})),e&&this.initItemsCode(e)}},h=function(){this._state.winSize=d(),e.requestAnimationFrame(u.bind(this))},d=function(){var t=e.document.documentElement;return{height:t.clientHeight,width:t.clientWidth}},p=function(t){var e,n=this._state;n.areListernersActive!==t&&(n.areListernersActive=t,t?(e="on",n.handlers={resize:i(h.bind(this),100),scroll:i(u.bind(this),100)}):e="off",r[e]("resize",n.handlers.resize),r[e](c,n.handlers.scroll))},m=function(t){var e=this._state.items;t.each((function(t,n){var s=e.indexOf(n);-1!==s&&e.splice(s,1)}))},f=function(){return{loadTimeout:this._opts.loadTimeout,checkRawItems:this._opts.checkRawItems||{}}},g=s.Constructors.getView({_Init:function(){this._state={items:[],winSizes:d(),handlers:{}},a&&"ru.mail.media.parallaxSlot"in e&&(c=l),this.processItems(),this._state.items.length&&r.on("load",i(h.bind(this),100))},processItems:function(t){var e=this._state,n=t||this._Elems.Parent,s=this._opts.cssSels.item,i=n.find(s).removeClass(s.slice(1));e.items=e.items.concat(Array.prototype.slice.call(i)),e.items.length&&(p.call(this,!0),u.call(this))},initItemsCode:function(t){var e=this._opts.failHandler,n=o(t,f.call(this));m.call(this,t),this._state.items.length||p.call(this,!1),"function"==typeof e&&(e=e.bind(this),n.forEach((function(t){t.then(null,e)})))}},{cssSels:{item:".js-wysiwyg__embedcode"},scrollLimit:400,loadTimeout:5e3,failHandler:null,checkRawItems:{}},null,"MediaEmbeds");e.getNameSpace("Modules",n).MediaEmbeds=g}(window.jQuery||window.$,window,window.ru.mail.cpf)},253:function(t,e,n){n(79),n(94),n(95),n(254)},254:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=n.Tools,o=s.moduleOpts.setParams,r=i.getTemplate,a=n.Tools.PubSub,l=s.Constructors._repo.get("Popup"),c={alert:r("ct-popup-alert.xml")};function u(e){var n=c.alert;n&&e&&e.text&&(this._alertPopup=new l(null,t(n(e))),this._alertPopup.show())}function h(t){var e=this._elems.tooltipInput;e.val(""),e.toggleClass(this._opts.cssClss.inputInvalid,!1),a.publish(t)}function d(){var t=this._model.getState();u.call(this,t)}o("NewsletterView",{options:{_Handlers:{dom:{"click:tooltipButton":function(t){t.preventDefault();var e=this._elems,n=this._opts.cssClss,s=e.tooltipInput,i=s.val(),o=this._model,r=/^.+@[\\.\w-]+$/.test(i);if(s.toggleClass(n.inputInvalid,!r),r){var a={email:i};o._state.announce&&(a.announce_model=o._state.announce),o.toggle(a)}}}},cssSels:{Main:{tooltipInput:".js-newsletter__tooltip-input"},tooltipButton:".js-newsletter__tooltip-button"},cssClss:{subscribed:"button_toggle button_toggle_icon",inputInvalid:"input__field_error",hidden:"hidden"}}}),o("NewsletterView.ModelPrice",{options:{_Handlers:{noAuth:function(){h.call(this,"newsletter.no-auth.model-price")},model:{update:d}}}}),o("NewsletterView.ConversionLink",{options:{_Handlers:{noAuth:function(){h.call(this,"newsletter.no-auth.conversion-link")},model:{update:d}},toggleParent:!0,cssClss:{subscribed:"hidden"},attrs:{theme:"data-theme"}}}),o("NewsletterView.Timeline",{options:{_Handlers:{noAuth:function(){h.call(this,"newsletter.no-auth.timeline")},model:{update:d}},cssClss:{subscribed:"button_toggle button_toggle_icon"}}}),o("NewsletterView.Huawei2018",{options:{_Handlers:{checkUser:function(){var t=this._elems.tooltipInput;n.Tools.Auth.onGetStatus(function(e){t&&t.length&&(t.val(e),t.prop("disabled",!!e))}.bind(this))},model:{update:d}},cssClss:{subscribed:"hidden"},checkOnInit:!0}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},255:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.typeOf,o=t(e),r=e.skrollr,a=e.Modernizr,l=a.touch||a.touchevents,c=a.csstransforms3d,u=/ipad|iphone|ipod/i.test(navigator.userAgent),h=e.requestAnimationFrame;function d(t,e){var n="top:"+t+"px;";return e&&(n+="left:"+e+"px;"),n}function p(e){var n=this._Elems.Parent,s=this._opts.Attrs,i=s.positionBottom,r=s.positionTop,a=n.offset().top,u=n.width(),h=n.height(),p=o.height(),m=t(document).height();this._layers.forEach((function(t){var e,n,s=t.layer,o=0;t.height=e=s.outerHeight(),t.width=n=s.outerWidth(),t.isCentered&&(o=Math.round((u-n)/2)),c||l?s.css("left",o):s.attr(i,d(h-e,o)).attr(r,d(0,o))})),this.bounds.min=Math.max(a-p,0),this.bounds.max=Math.min(a+h,Math.max(m-p,0)),this.bounds.range=this.bounds.max-this.bounds.min,c||!1===e||l||this._skrollr.refresh()}function m(){var t=this._opts.idPrefix+(Math.random()+"").replace(".","");return this._Elems.Parent.prop("id",t),"#"+t}function f(t,e){var n=o.scrollTop()+(isNaN(e)?0:e),s=this._opts.isSameScrollDirection?n-this.bounds.min:this.bounds.max-n,i=this.bounds.range&&s/this.bounds.range;i>=0&&i<=1&&i!==this.bounds.k&&(this._Elems.scrollCont.scrollTop(this._sizes.maxScroll*i),g.call(this,100*(1-i)),this.bounds.k=i),isNaN(e)&&h(f.bind(this))}function g(t){var e,n=this._customLayers,s=n.length;if(s)for(var i=0;i<s;i++)(e=n[i]).handler&&e.handler.call(this,e.element,t,e.data)}var _=s.Constructors.getView({_Init:function(){var s=this,a=this._opts,h=this._Elems,d=a.Attrs,_=h.Parent,v=d.layerIndex,w=d.anchorTarget,b=d.layerCentered,y=d.scrollHandler,C=_.prop("id"),P=C?"#"+C:m.call(this),S=[],I=[],T=n.Tools.Images.preloadImage,E=p.bind(this),M=Array.from(_.find("img")).map((function(t){return T(t.src)}));l=i(a.isTouchDevice,"boolean")?a.isTouchDevice:l,h.layer.each((function(e,n){S.push({layer:t(n),isCentered:!!n.getAttribute(b)}),n.setAttribute(w,P),n.setAttribute(v,e)})),h.customLayer&&h.customLayer.each((function(t,e){var n=e.getAttribute(y),s=n&&a.scrollHandlers[n];s&&I.push({element:e,data:{},handler:s})})),this._layers=S,this._customLayers=I,this._sizes={},this.bounds={},Promise.all(M).then((function(){var n,i=0,d=t(document),p=a.mouseWheelLimit;if(E(!1),c&&!u)h.baseLayer.each((function(){i=Math.max(i,this.offsetHeight)})),s._sizes.maxScroll=i-h.Parent.height(),f.call(s),d.on("mousewheel",(function(t){var e,i=t.originalEvent,r=i.deltaY;isNaN(r)&&(n?r=i.wheelDelta/-120*n:(e=o.scrollTop(),d.one("scroll",(function(){n=Math.abs(o.scrollTop()-e)})),r=-i.wheelDelta)),Math.abs(r)>p&&f.call(s,null,r)}));else if(l)_.addClass(a.cssClss.touchDevice);else{var m=r.get(),v=a.skrollrOpts;s._customLayers.length&&(v.beforerender=function(t){var e,n=s.bounds,i=t.curTop;i>n.min&&i<n.max&&(e=100*(i-n.min)/n.range,g.call(s,e))}),m?m.refresh():m=r.init(v),s._skrollr=m}o.on("resize",e.requestAnimationFrame.bind(null,E)).on("load",E),a.heightChangeEvent&&d.on(a.heightChangeEvent,E)}),(function(){}))}},{cssSels:{Main:{layer:".js-parallax__layer",customLayer:".js-parallax__custom",baseLayer:".js-parallax__layer_base",scrollCont:".js-parallax__scroll"}},cssClss:{touchDevice:"p-parallax_touch"},Attrs:{anchorTarget:"data-anchor-target",layerIndex:"data-layer-index",layerCentered:"data-layer-centered",positionTop:"data-top-bottom",positionBottom:"data-bottom-top",scrollHandler:"data-scroll-handler"},scrollHandlers:{},idPrefix:"parallaxBlock_",onBeforeRefresh:null,isTouchDevice:null,isSameScrollDirection:!1,heightChangeEvent:"documentHeightChange",mouseWheelLimit:60,skrollrOpts:{forceHeight:!1,smoothScrolling:!1}},null,"ParallaxBlock");e.getNameSpace("Modules",n).ParallaxBlock=_,t.fn.ParallaxBlock=function(n){return e.DEBUG&&e.console.warn("Обнаружено старое подключение компонента.\t\t\t\tНеобходимо срочно сменить его на обычное, так как скоро старое перестанет работать"),this.each((function(){new _(n,t(this))}))},s.moduleOpts.setParams("ParallaxBlock.Autoinit",{initializer:function(t,e){t.isTouchDevice.then((function(t){new _({isTouchDevice:t},e)}))},options:{isTouchDevice:new Promise((function(t){t(!(e.Modernizr.csstransforms3d&&!l)&&n.Tools.checkDeviceType().then((function(t){return"tablet"===t})))}))}})}(window.jQuery,window,window.ru.mail.cpf)},256:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.getOptions,o=s.Extend,r=e.Modernizr,a=r.touch||r.touchevents,l=r.csstransforms3d,c=e.navigator.userAgent.toLowerCase(),u=t(".js-slot-parallax"),h=t(e),d=!1,p=n.Modules.ParallaxBlock,m=n.Tools.PubSub;function f(n){if(!d){d=!0,n=s.typeOf(n,"boolean")?n:null;var r,a=s.moduleOpts.getParams("ParallaxBlock")||{},h=o(!0,a,{isTouchDevice:n});u.each((function(e,n){var s=i(n)||{};new p(o(!0,{},h,s.parallaxOpts),t(n))})),l||(r="firefox",-1!==c.indexOf(r))||e.promisifiedDomEvents.ready.then((function(){var s,i;(s=-1==navigator.userAgent.toLowerCase().indexOf("webkit")?"html":"body",(i=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./))&&parseInt(i[2],10)>=61&&(s="html"),t(s)).smoothWheel({isTouchDevice:n,globalState:e.getNameSpace("ru.mail.auto").State||null})}))}}u.length&&(l&&!a?f(!1):(n.Tools.checkDeviceType().then((function(t){f(a="tablet"==t)})),h.one("touchstart",f))),m&&m.subscribe("adqSlotAdded",(function(e){t("["+e.data.idAttribute+'="'+e.data.id+'"]').find(".js-slot-parallax").length&&!d&&(d=!0,n.Tools.initModules(t(".js-slot-parallax"),{cssSels:{module:".js-slot-parallax"}}))}))}(window.jQuery,window,window.ru.mail.cpf)},257:function(t,e){!function(t,e,n){"use strict";var s,i,o=n.Basic.getModel,r=n.Tools.transport;o((s=function(t){var e=this._opts.normalizeData.call(this,t);this._trigger("fetch",e)},i=function(){},{_Events:["fetch"],fetch:function(){var t=this._opts;return(0,t.transport)({url:t.url}).then(s.bind(this),i.bind(this))}}),{transport:function(t){return r(t)},url:null,normalizeData:function(t){return t}},null,"PopupViaRequestModel")}(window.jQuery,window,window.ru.mail.cpf)},258:function(t,e){!function(t,e,n){"use strict";var s,i=n.Basic.getView,o=n.Basic.moduleOpts.setParams,r=n.Tools.initModules;i((s=function(t){var e=this._Opts.template,n=this._Opts.prepareData.call(this,t||{});return e.asyncRender(n)},{_Events:["toggle"],_Handlers:{dom:{"click:Main.urls":function(t){t.preventDefault(),this._ready?this._popup.Show():(this._ready=!0,this._popup.togglePreload(!0,this._model.fetch()))}},model:{fetch:function(t){s.call(this,t).then(function(t){var e=this._popup,n=e._Elems.jBlock,s=e.Show.bind(e);setTimeout((function(){n.html(t),r(n),s()}),500)}.bind(this))}}},_Init:function(){if(void 0===this._Opts.template||null===this._Opts.template)throw new TypeError("no template installed");this._ready=!1,this._popup=t("<div/>").Popup({onHide:function(){this._trigger("toggle",!1)}.bind(this),onShow:function(){this._trigger("toggle",!0)}.bind(this)}).data("_popupObj")}}),{cssSels:{Main:{urls:".js-popupviewrequest__url"}},template:null,once:!0,prepareData:function(t){return t}},null,"PopupViaRequestView"),o("PopupViaRequestView",{acceptTypes:["PopupViaRequestModel"]})}(window.jQuery,window,window.ru.mail.cpf)},259:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams,i=n.Tools.getTemplate;s("PopupViaRequestModel.Vendors",{paramAttrs:{url:"data-url"},options:{normalizeData:function(t){return{items:(t.data||[]).map((function(t){return{image:t.Picture,name:t.Name,url:t.catalog_url}}))}}}}),s("PopupViaRequestView.Vendors",{options:{template:i("ct-popup-vendors.xml"),_Handlers:{toggle:function(t){if(t){var e=this._popup._Elems.jBlock.find(".js-module[data-module]").data("CustomScroll");e&&setTimeout((function(){e.Resize()}),500)}}}}})}(window.jQuery,window,window.ru.mail.cpf)},28:function(t,e){!function(t,e,n){"use strict";var s=n.Basic;(0,s.Extend)(!0,n,{Modules:{Toggle:s.getView(function(){function n(){var t=this._opts,e=t.cssClss.hidden;t.hideButton&&this._state.shown&&this._elems.button.addClass(e)}function s(){var t=this._opts,e=this._elems,n=t.cssClss,s=this._state.heights,o=this._state.shown,r=e.container;this._state.animate=!0,i.call(this).addClass(n.hidden),r.css({height:o?"0":s.container})}function i(){var t=this._elems.container;return this._opts.toggleParent||!t?this._elems.parent:t}return{_Events:["toggle","buttonClick"],_Handlers:{"dom:click:button":"_onClick","dom:webkitTransitionEnd msTransitionEnd oTransitionEnd transitionend:Main.container":"_onTransitionEnd"},toggleBlock:function(){var t=this._opts,o=this._elems,r=t.cssClss;if((o.container||{}).length){var a=this._state.shown;t.animate?s.call(this):(i.call(this).toggleClass(r.hidden),this._state.shown=!a,n.call(this),this._trigger("toggle"));var l=document.createEvent("HTMLEvents");l.initEvent("resize",!0,!0),e.dispatchEvent(l)}},_onClick:function(e){var n=this._opts.cssSels.preventToggle;n&&(t(e.target).is(n)||t(e.target).parents(n).length)||(e.preventDefault(),this.toggleBlock(),this._trigger("buttonClick",e))},_onTransitionEnd:function(e){var s=this._state.shown,o=this._state.animate;o&&t(e.target).is(this._opts.cssSels.Main.container)&&(this._state.shown=!s,n.call(this),i.call(this).toggleClass(this._opts.cssClss.hidden,s),this._trigger("toggle"),o=!1)},_Init:function(){var t=this._opts,e=this._elems,n=t.cssClss,s=e.container;if((s||{}).length){var o=e.container[0].scrollHeight,r=i.call(this).hasClass(n.hidden);this._state={shown:!r,animate:!1,heights:{container:o}},this._state.shown&&t.animate&&s.css("height",o)}}}}(),{cssSels:{Main:{block:".js-toggle",button:".js-toggle__button",container:".js-toggle__container"},button:".js-toggle__button",preventToggle:null},cssClss:{hidden:"hidden_all"},animate:!1,hideButton:!1,toggleParent:!1},null,"Toggle")}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},29:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.moduleOpts.setParams;s("CustomScroll",{options:{cssSels:{Main:{scrollBar:".js-scrollbar",scrollView:".js-scrollable__view"},scrollBar:{scrollThumb:".js-scrollbar__track",scrollThumbBody:".js-scrollbar__track__drag"},scrollThumbSize:".js-scrollbar__track__drag__point"}}}),s("CustomScroll.Popup",{options:{_Handlers:{init:function(){setTimeout(this.Resize.bind(this),100)}}}})}(window.jQuery,window,window.ru.mail.cpf)},31:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(16),i=n(4),o=n(11),r=n(18),a=!1;e.init=function(t){return new Promise((function(e,n){return a?(i.print.warn("MPF is already started"),e()):(t&&r.applicationSettings.update(t),a=!0,o.resolveConfigSetters().then((function(t){var n=function(){i.print.info("MPF init. Env: production"),s.initAllComponents(document.body),e()};"loading"!==document.readyState?n():document.addEventListener("DOMContentLoaded",n)})))}))}},32:function(t,e,n){"use strict";var s=n(0)(n(1));Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return null!=t&&"object"===(0,s.default)(t)&&!(t instanceof Promise)};e.deepMerge=function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var o={},r=0,a=e;r<a.length;r++){var l=a[r];if("object"===(0,s.default)(l)&&null!==l)for(var c=Object.keys(l),u=0,h=c;u<h.length;u++){var d=h[u],p=l[d];if(p instanceof Date){var m=new Date;m.setTime(p.getTime()),o[d]=m}else p instanceof RegExp?o[d]=new RegExp(p):Array.isArray(p)?o[d]=Array.prototype.concat.call([],p):i(p)?o[d]=t(o[d],p):o[d]=p}}return o}},33:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getIn=function(t,e){return function e(n,s){if(0===s.length)return n!==t?n:null;var i=n[s[0]];return null==i?null:e(i,s.slice(1))}(t,e)},e.setIn=function(t,e,n){return function t(e,n,s){return 1===n.length?(e[n[0]]=s,e[n[0]]):(null!==e[n[0]]&&void 0!==e[n[0]]||(e[n[0]]=e[n[0]]||{}),t(e[n[0]],n.slice(1),s))}(t,e,n),t}},34:function(t,e,n){"use strict";var s,i=(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.emit("ready"),e}return i(e,t),e}(n(35).EventEmitter);e.Emitter=o},342:function(t,e){!function(t,e){"use strict";var n=e.Basic.Extend,s=e.Mixins,i={urls:[],articles:[{articleData:{layout:{canonical:t.location.href},content:{title:document.title}}}]};e.Basic.getModel(function(){function t(t,e){this._state=n({},this._state,t),this._trigger("stateUpdated",this._state),e&&this._trigger(e,this._state)}function e(){var t=this.transport,e=this._state.articles.length;return t({url:this._state.urls[e-1].url_part})}function o(e){var n=this._state.articles.concat(e);this._isFetching=!1,t.call(this,{articles:n},"articlesReady"),this._trigger("dataReceived")}function r(t){throw this._isFetching=!1,this._trigger("dataFailed",t),t}return{_Init:function(e){this._isFetching=!1,t.call(this,n({},i,e))},_mixins:[s.transport],_Events:["dataFetching","dataReceived","dataFailed","stateUpdated","articlesReady"],getState:function(){return n(!0,{},this._state)},setState:function(e){t.call(this,e)},setArticleEl:function(t,e){this._state.articles[e].el=t},fetch:function(){this._isFetching=!0,this._trigger("dataFetching"),e.call(this).then(o.bind(this)).catch(r.bind(this))},isFetching:function(){return this._isFetching}}}(),{},null,"DigestNewsModel")}(window,window.ru.mail.cpf)},343:function(t,e,n){var s=n(22);!function(t,e,n){"use strict";var i=n.Tools,o=i.initModules,r=i.Counters.hitCntrsBlck,a=i.getTemplate,l=i.triggerResize,c=n.Basic,u=c.Extend,h=c.debounce,d=c.getByPath,p=t(document),m={cssSels:{Main:{footer:".js-likemore__footer"},container:".js-likemore__container"},cssClss:{hidden:"hidden"},attrs:{articleIndex:"data-article-index"},templates:{article:a("ct-article-digest.xml")},maxArticles:4,fetchPoint:20};n.Basic.getView(function(){function n(t){if(this._elems.article&&this._elems.article[t])return this._elems.article[t];var e=this._opts.cssSels.container;return this._elems.article=this._elems.parent.find(e),this._elems.article[t]}function i(){(function(t,n){var s=p.height();return t.height-t.bottom>t.height/100*n||e.scrollY===s-document.documentElement.clientHeight})(n.call(this,this._articlesLength-1).getBoundingClientRect(),this._opts.fetchPoint)&&this._model.fetch()}function a(t){var n=this._articles[t],s=d("articleData.layout.canonical",n),i=d("articleData.content.title",n);n&&e.location.href!==s&&(e.history.replaceState(null,i,s),document.title=i,function(t,n){var s=e._mediator;s&&(s.stop(),s.start({target:t,url:n}))}(n.el,s),r({url:s}))}var c=h((function(){this._model.isFetching()||this._articlesLength<this._opts.maxArticles&&i.call(this)}),250);function m(t,e){this._articles=t||this._model.getState().articles,this._articlesLength=e||this._articles.length,this._articleUrls=this._model.getState().urls}function f(){var t=this,e=this._opts,n=e.cssSels.container,s=e.attrs.articleIndex,i=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&a.call(t,e.target.getAttribute(s))}))}));document.querySelectorAll(n).forEach((function(t){i.observe(t)}))}return{_Init:function(){this._footerIsHidden=!0,this._windowHeight=document.documentElement.clientHeight,this._model.setArticleEl(this._elems.parent[0].querySelector(this._opts.cssSels.container),0),m.call(this),f.call(this),t(e).on("scroll",c.bind(this))},_Handlers:{model:{articlesReady:function(e){var n=this,i=e.articles.length,r=i-1,a=e.articles[i-2].el,c=e.articles[r].articleData;this._opts.templates.article.asyncRender(u({},{expArticleIndex:r},c)).then((function(c){a.insertAdjacentHTML("afterEnd",c),n._model.setArticleEl(a.nextElementSibling,r);var u=e.articles[r].el;o(t(u)),(0,s.initAllComponents)(u),m.call(n,e.articles,i),f.call(n),setTimeout(l,700)}))}}}}}(),m,null,"DigestNewsView")}(window.jQuery||window.$,window,window.ru.mail.cpf)},344:function(t,e){!function(t){"use strict";var e=window.ru.mail.cpf.Basic.moduleOpts.setParams;e("DigestNewsModel",{options:{}}),e("DigestNewsView",{acceptTypes:"DigestNewsModel",options:{}})}()},345:function(t,e){!function(t,e){"use strict";var n=e.Basic.getView,s=!1,i=1,o=2,r=3,a=4;n(function(){function e(n){var s;s=n.isCarousel?n.withDescription?i:r:n.withDescription?o:a,t.removeEventListener("YaMarketAffiliateLoad",e),t.YaMarketAffiliate.createWidget({containerId:n.container,type:n.type?n.type:"offers",params:{clid:this._opts.clid,searchModelIds:[n.modelId],searchCategoryIds:[n.groupId],searchVendorIds:[n.vendorId],sovetnikPromo:!1,themeId:s,searchText:n.searchText}})}return{_Init:function(){var e=this._opts,n=this._elems,i=e.attrs,o=e.dataYaWidget;n.containers&&(!function(){if(!s){s=!0;var e=document.createElement("script");e.setAttribute("async","async"),e.setAttribute("src","https://aflt.market.yandex.ru/widget/script/api"),e.setAttribute("type","text/javascript"),t.document.head.appendChild(e)}}(),[].forEach.call(n.containers,function(t){var e=t.getAttribute(i.dataWithDescription),n=!!e&&JSON.parse(e),s=t.getAttribute(i.dataIsCarousel),r=!!s&&JSON.parse(s),a={modelId:t.getAttribute(i.dataModelId),groupId:t.getAttribute(i.dataGroupId),vendorId:t.getAttribute(i.dataVendorId),type:t.getAttribute(i.dataType),searchText:t.getAttribute(i.dataSearchText),isCarousel:r,container:t.getAttribute("id"),withDescription:n};if(t.classList.contains("js-lazy")){new MutationObserver((function(t,e){Object.keys(t).forEach((function(n){t[n].attributeName===o&&(this.runYaWidget(a),e.disconnect())}))})).observe(t,{attributes:!0,childList:!1,subtree:!1})}else this.runYaWidget(a)}.bind(this)))},runYaWidget:function(n){t.YaMarketAffiliate?e.call(this,n):t.addEventListener("YaMarketAffiliateLoad",e.bind(this,n))}}}(),{clid:null,cssSels:{Main:{containers:".js-yawidget"}},attrs:{dataModelId:"data-model-id",dataGroupId:"data-group-id",dataVendorId:"data-vendor-id",dataIsCarousel:"data-is-carousel",dataWithDescription:"data-with-description",dataType:"data-widget-type",dataSearchText:"data-search-text"},dataYaWidget:"data-yawidget-shown"},null,"YandexWidget")}(window,window.ru.mail.cpf)},346:function(t,e){!function(t,e){"use strict";var n=e.Basic.getView,s=e.Tools.transport;function i(t){var e=this._opts.attrs,n=e.dataAligateProductId,s=e.dataAligateCn,i=t.getAttribute(n),o=t.getAttribute(s);if(i&&o)return{aliExpressProductID:i,cn:o};console.error("Не указан productId или cn счётчика для которого создаётся событие")}n({_Handlers:{"dom:click:container":function(t){var e=this._opts.transportOpts,n=t.currentTarget,o=i.call(this,n);s({type:e.type,url:e.urlClicks,data:o}).then((function(t){return t.text()}))}},_Init:function(){var t=this,e=this._opts,n=e.transportOpts,o=this._elems.parent.get(0).querySelectorAll(e.cssSels.container),r=new IntersectionObserver((function(e,o){e.forEach((function(e){if(e.isIntersecting){var r=e.target,a=i.call(t,r);o.unobserve(r),s({type:n.type,url:n.urlViews,data:a}).then((function(t){return t.text()}))}}))}),e.observerOpts);o.forEach((function(t){r.observe(t)}))}},{cssSels:{container:".js-aligate"},attrs:{dataAligateProductId:"data-aligate-product-id",dataAligateCn:"data-aligate-cn"},observerOpts:{root:null,rootMargin:"0px",threshold:0},transportOpts:{type:"POST",urlViews:"/aligate/api/metrics/views/",urlClicks:"/aligate/api/metrics/clicks/"}},null,"AligateMetrics")}(window,window.ru.mail.cpf)},347:function(t,e){!function(t,e,n){"use strict";(0,n.Basic.moduleOpts.setParams)("YandexWidget",{options:{clid:2310903}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},35:function(t,e,n){"use strict";var s,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};s=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!=t};function a(){a.init.call(this)}t.exports=a,t.exports.once=function(t,e){return new Promise((function(n,s){function i(n){t.removeListener(e,o),s(n)}function o(){"function"==typeof t.removeListener&&t.removeListener("error",i),n([].slice.call(arguments))}_(t,e,o,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&_(t,"error",e,n)}(t,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function u(t){return void 0===t._maxListeners?a.defaultMaxListeners:t._maxListeners}function h(t,e,n,s){var i,o,r,a;if(c(n),void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),r=o[e]),void 0===r)r=o[e]=n,++t._eventsCount;else if("function"==typeof r?r=o[e]=s?[n,r]:[r,n]:s?r.unshift(n):r.push(n),(i=u(t))>0&&r.length>i&&!r.warned){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=r.length,a=l,console&&console.warn&&console.warn(a)}return t}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(t,e,n){var s={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=d.bind(s);return i.listener=n,s.wrapFn=i,i}function m(t,e,n){var s=t._events;if(void 0===s)return[];var i=s[e];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(i):g(i,i.length)}function f(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(t,e){for(var n=new Array(e),s=0;s<e;++s)n[s]=t[s];return n}function _(t,e,n,s){if("function"==typeof t.on)s.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function i(o){s.once&&t.removeEventListener(e,i),n(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},a.prototype.getMaxListeners=function(){return u(this)},a.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var s="error"===t,i=this._events;if(void 0!==i)s=s&&void 0===i.error;else if(!s)return!1;if(s){var r;if(e.length>0&&(r=e[0]),r instanceof Error)throw r;var a=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw a.context=r,a}var l=i[t];if(void 0===l)return!1;if("function"==typeof l)o(l,this,e);else{var c=l.length,u=g(l,c);for(n=0;n<c;++n)o(u[n],this,e)}return!0},a.prototype.addListener=function(t,e){return h(this,t,e,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(t,e){return h(this,t,e,!0)},a.prototype.once=function(t,e){return c(e),this.on(t,p(this,t,e)),this},a.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,p(this,t,e)),this},a.prototype.removeListener=function(t,e){var n,s,i,o,r;if(c(e),void 0===(s=this._events))return this;if(void 0===(n=s[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===e||n[o].listener===e){r=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,i),1===n.length&&(s[t]=n[0]),void 0!==s.removeListener&&this.emit("removeListener",t,r||e)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(t){var e,n,s;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var i,o=Object.keys(n);for(s=0;s<o.length;++s)"removeListener"!==(i=o[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(s=e.length-1;s>=0;s--)this.removeListener(t,e[s]);return this},a.prototype.listeners=function(t){return m(this,t,!0)},a.prototype.rawListeners=function(t){return m(this,t,!1)},a.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):f.call(t,e)},a.prototype.listenerCount=f,a.prototype.eventNames=function(){return this._eventsCount>0?s(this._events):[]}},36:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(37))},37:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof __REDUX_DEVTOOLS_EXTENSION__;var i=function(){function t(){var t=this;this.subscriptions={},s&&(this.devTools=__REDUX_DEVTOOLS_EXTENSION__.connect(),this.devTools.subscribe((function(e){if("DISPATCH"===e.type&&"JUMP_TO_STATE"===e.payload.type)for(var n=0,s=Object.keys(t.subscriptions);n<s.length;n++){var i=s[n];t.subscriptions[i](e)}})))}return t.prototype.subscribe=function(t,e){var n="handler_"+t;this.subscriptions[n]||(this.subscriptions[n]=e)},t.prototype.send=function(t,e){s&&this.devTools&&this.devTools.send(t,e)},t.prototype.remove=function(t){delete this.subscriptions["handler_"+t]},t}();e.DevToolsExtension=i},375:function(t,e,n){n(28),n(217)},376:function(t,e){!function(t,e,n){"use strict";var s=e.DEBUG;(0,n.Basic.getView)({_mixins:[n.Mixins.transport],_Handlers:{dom:{"change:Main.showDifferent":function(t){var e=t.currentTarget;this._elems.showDifferent.not(e).prop("checked",e.checked),this.toggleDifferent(e.checked)},"mouseenter mouseleave:Main.rows":function(e){var n=t(e.currentTarget).closest("."+this._opts.cssClss.table);this._elems.tables.not(n).find("."+this._opts.cssClss.row).eq(n.find("."+this._opts.cssClss.row).index(e.currentTarget)).toggleClass(this._opts.cssClss.rowHover,"mouseenter"===e.type)},"click:Main.removeModel":function(n){n.preventDefault();var i=t(n.currentTarget).closest(".js-remove-model");if(i.length){var o=i.data("delete-url");this.transport({url:o,csrf:!0,type:"POST"}).then(function(t){e.location.href=t.data.url}.bind(this)).catch((function(t){s&&e.console.log("CompareTable:",t)}))}}}},toggleDifferent:function(t){this._elems.sameRows.toggle(!t)}},{cssSels:{Main:{showDifferent:".js-compare-table__toggle-diff",tables:".p-compare-table__table",blocks:".p-compare-table__row",rows:".p-compare-table__tr",removeModel:".p-compare-table__remove",sameRows:".js-compare__diff"}},cssClss:{table:"p-compare-table__table",row:"p-compare-table__tr",rowHover:"p-compare-table__tr_hover"}},null,"CompareTable")}(window.jQuery||window.$,window,window.ru.mail.cpf)},38:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(20);e.DOMComponent=s.DOMComponent,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n(43))},39:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(9),i=n(5),o=n(19),r=0,a=function(){function t(t,e,n){void 0===e&&(e={}),void 0===n&&(n={}),this._ns=t,this._id=++r,this._options=s.deepMerge({},this.getDefaultOptions(),e),this._initialState=s.deepMerge({},this.getInitialState(),n)}return t.prototype.init=function(){},t.prototype.getDefaultOptions=function(){return{}},t.prototype.getInitialState=function(){return{}},Object.defineProperty(t.prototype,"alias",{get:function(){var t=this.constructor;return this._alias||t.registryName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ns",{get:function(){return this._ns?""+this.alias+i.COMPONENT_NS_DELIMITER+this._ns:this.alias},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"identity",{get:function(){return""+this.ns+i.COMPONENT_NS_DELIMITER+this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.getState()},enumerable:!0,configurable:!0}),t.prototype.setState=function(t){return this._store.put(t)},t.prototype.getState=function(){return this._store.read()},t.prototype.update=function(t,e){},t.prototype.canDispatch=function(){return!o.Store.hasEntity(this.identity)},t.prototype.dispatchStore=function(t,e){this.shouldUpdate(t,e)&&this.update(t,e)},t.prototype.shouldUpdate=function(t,e){return!0},t.prototype.reset=function(){this._store.destroy(),this.dispatch(this._alias)},t.prototype.preDispatch=function(){},t.prototype.postDispatch=function(){},t.prototype.dispatch=function(t){return this.canDispatch()&&(this._alias=t,this._store=new o.Store(this.identity,this._initialState,this.dispatchStore.bind(this)),this.preDispatch(),this._store.dispatch(),this.postDispatch(),this.init()),this},t}();e.Component=a},4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=console&&console.groupCollapsed&&console.groupEnd&&console.log&&!1,i=function(){function t(t){var e=new Date;this.state={messages:t,prefix:"["+e.getHours()+":"+a(e.getMinutes())+":"+a(e.getSeconds())+"]",icon:"🤖"}}return t.prototype.toArray=function(){var t=this.state,e=t.icon,n=t.prefix,s=t.messages;return[e,n].concat(s)},t.prototype.str=function(){return this.toArray().join(" ")},t.prototype.prefix=function(t){return this.state.prefix=t,this},t.prototype.log=function(){return this.state.icon="🤖",this},t.prototype.info=function(){return this.state.icon="💁‍♂️",this},t.prototype.error=function(){return this.state.icon="💩",this},t.prototype.warn=function(){return this.state.icon="😢",this},t.prototype.icon=function(t){return this.state.icon=t,this},t}();function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new i(t)}function r(t,e){var n;return void 0===e&&(e=[]),s?(n=Function.prototype.bind).call.apply(n,[console[t],console].concat(e)):function(){}}function a(t){return(t>9?"":"0")+t}e.FormatDescriptor=i,e.format=o,e.print={log:r("log",o().log().toArray()),info:r("info",o().info().toArray()),warn:r("warn",o().warn().toArray()),error:r("error",o().error().toArray()),groups:function(t,e){if(s){console.groupCollapsed(o(t).str());for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];console.groupCollapsed(r),console.log.apply(console,e[r]),console.groupEnd()}console.groupEnd()}}}},40:function(t,e,n){"use strict";function s(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),s(n(41)),s(n(42))},41:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(21),i=n(4),o=n(5),r=n(10);function a(t,e){return t.split(e).map((function(t){return t.trim()}))}function l(t,e){var n=new RegExp(e+"\\"+o.COMPONENT_DATA_BIND_DEF_DELIMITER,"g");return t.replace(n,"")}function c(t,e){return function(n){if(t in r.DOM_ELEMENT_PROPERTIES)n[t]=e;else if(t in r.DOM_ELEMENT_ATTRIBUTES)switch(r.DOM_ELEMENT_ATTRIBUTES[t]){case r.MPFAttributeType.BOOLEAN:e?n.setAttribute(t,t):n.removeAttribute(t);break;case r.MPFAttributeType.STRING:n.setAttribute(t,e)}else n.setAttribute(t,e)}}e.dataBinder=function(t,e){var n=new s.Collector(t,e);return function(t,e,s){e((function(){for(var e=n.group(t.$,t.alias),r=0,u=Object.keys(e);r<u.length;r++)for(var h=u[r],d=0,p=a(l(h,t.alias),o.COMPONENT_DATA_BIND_PROP_DELIMITER);d<p.length;d++){var m=a(p[d],o.COMPONENT_DATA_BIND_EQ),f=m[0],g=m[1];if("function"!=typeof t[g])i.print.warn("Method '"+g+"' not found in '"+t.alias+"' for key '"+h+"'");else{var _=e[h],v=t[g].bind(t)(s());_.forEach(c(f,v))}}}))}}},42:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(5),i=["focus","blur"];e.eventsBinder=function(t,e){var n={};return function(o){for(var r=function(t){for(var e={},n=0,i=Object.keys(t);n<i.length;n++){var o=i[n],r=o.split(s.COMPONENT_EVENT_DELIMITER),a=r[0],l=r[1];e[a]||(e[a]=[]);var c={name:l,handler:t[o]};e[a]=e[a].concat(c)}return e}(o),a=function(s){var o=function(n){for(var i=0,o=r[s];i<o.length;i++){var a=o[i],l=a.name,c=a.handler,u=n.target;if(null===u)return;for(var h=e(l);u!==t;){if(-1!==h.indexOf(u))return void c(n);u=u.parentNode}}},a=-1!==i.indexOf(s);t.addEventListener(s,o,a),n[s]={unbind:function(){t.removeEventListener(s,o)}}},l=0,c=Object.keys(r);l<c.length;l++){a(c[l])}return function(){for(var t=0,e=Object.keys(n);t<e.length;t++){var s=e[t];n[s].unbind(),delete n[s]}}}}},43:function(t,e,n){"use strict";var s,i=(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var o=n(20),r=n(4),a=n(18),l={},c=function(t,e,n){return t+"/"+e+"/"+e+n},u=function(t){return t+".xml"};function h(t,e){var n=e||{},s=a.applicationSettings.getState(),i=s.templatesPath,o=s.templatesNS,h=s.templatesExt;if(!i)throw new Error(r.format('Invalid application settings: "templatesPath"').error().str());if(!o)throw new Error(r.format('Invalid application settings: "templatesNS"').error().str());var d=n.getName,p=n.getPath,m="function"==typeof d?d(t):u(t),f="function"==typeof p?p(i,t,h):c(i,t,h);if(l[f])return l[f];var g=new Promise((function(t,e){var n=window[o];if(n&&n[m])return t(n[m]);var s=document.createElement("script");s.async=!0,s.type="text/javascript",s.src=f,s.addEventListener("load",(function(){n&&n[m]?t(n[m]):e(new Error(r.format('Unable to read template "'+m+'"').error().str()))})),s.addEventListener("error",(function(){e(new Error(r.format('Unable to load template from "'+m+'"').error().str()))})),document.head.appendChild(s)}));return l[f]=g,g.then((function(t){return delete l[f],t}))}e.resolveTemplate=function(t,e){return function(){return"function"==typeof t?(n=t,Promise.resolve(n)):"string"==typeof t?h(t,e):Promise.reject(new Error(r.format("Invalid template").error().str()));var n}};var d=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.update=function(e,n){var s=this;t.prototype.update.call(this,e,n),(0,this.options.template)().then((function(t){var e=s.getState();s.render(t,e)})).catch((function(t){r.print.warn(t.message)}))},n.prototype.render=function(t,e){var n=t(e);this.$.innerHTML=n},n.getTemplate=e.resolveTemplate,n}(o.DOMComponent);e.TemplateComponent=d},44:function(t,e){!function(t,e){e.promisifiedDomEvents.ready.then((function(){var e,n=t(".js-branding"),s=n.find(".js-branding__video"),i=s.get(0),o=1;if(i){var r=".js-branding__play-pause",a=".js-branding__volume",l=".js-branding__expand",c=".js-branding__center",u="toggle_active",h="pc-branding__cell_expanded",d=s.data("count-duration"),p={start:(d=d?d.split(","):[])[0],middle:d[1],end:d[2],pause:s.data("count-pause")||"",volume:s.data("count-volume")||"",expand:s.data("count-expand")||""},m=function(t){if(t){var e=t.toString().match("//")?t:"//rs.mail.ru/d"+t+".gif?"+parseInt(1e5*Math.random());return(new Image).src=e}},f=function(){o?(i.play(),o=0):(i.pause(),o=1),t(r).toggleClass(u)};n.on("click",r,(function(){f(),p.pause&&(m(p.pause),p.pause=null)})),n.on("click",a,(function(){s.prop("muted",!s.prop("muted")),t(this).toggleClass(u),p.volume&&(m(p.volume),p.volume=null)})),n.on("click",l,(function(){t(c).toggleClass(h),p.expand&&(m(p.expand),p.expand=null)})),i.onplay=function(){var t,n,s,o=i.currentTime;o<1&&m(p.start),e=setInterval((function(){o/i.duration*100>50&&!t&&(m(p.middle),t=!0),o<s&&!n&&(m(p.end),n=!0,clearInterval(e)),s=o}),500)},f()}}))}(window.jQuery,window)},5:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.COMPONENT_DELIMITER=",",e.COMPONENT_EVENT_DELIMITER=":",e.COMPONENT_NS_DELIMITER=".",e.COMPONENT_EL_DELIMITER=".",e.COMPONENT_DATA_BIND_DEF_DELIMITER="|",e.COMPONENT_DATA_BIND_EQ="=",e.COMPONENT_DATA_BIND_PROP_DELIMITER=";"},51:function(t,e,n){!function(t,e,n){var s=n.Basic,i=s.typeOf,o=s.Extend,r=s.getView(function(){var n,s="background-size"in(n=document.createElement("div").style)||"backgroundSize"in n,r=["width","height"],a=r.reduce((function(t,e){return t[e]="",t}),{});function l(e,n,s){var o,r,a,l,c,u,h=this._opts.infoAppend;Array.isArray(s)||(s=Object.keys(e));for(var d=s.length;d--;)(o=s[d])in e&&(r=e[o],i(r,"string")&&(r=this._getViewParent().find(r)),r instanceof t&&r.length&&(a=n[o],c=i(a),u=h[o],"boolean"===c?r.toggle(a):i(u,"function")?u.call(this,r,a):(l=null!==a&&"undefined"!==c&&!("string"===c&&0===a.length),r.toggle(l),l&&("A"===r.get(0).tagName?r.attr("href",a):r.html(a)))))}function c(e,n){return n?"nodeType"in n?t(n):n:e}var u=function(t){this._state=o({},this._state,t||{})},h=function(){return o(!0,{},this._state)};return{_Handlers:{dom:{"click:Main.imageView":"_onImageClick","click:reloadImage":function(t){this._model.reloadImage(this._model.getCurrentImage().image,this._opts.imagesVersion),t.preventDefault()}},model:{imagechange:"_onImageChange",imageready:"_onImageReady",imagefail:"_onImageFail",setchange:"_onSetChange"}},_Init:function(){var t=this._opts,e=t.imagesSet;if(this._imagesSet=null===e?e:1*e,this._imagesVersion=+t.imagesVersion,isNaN(this._imagesSet)||isNaN(this._imagesVersion))throw new TypeError("imagesSet");null!==e&&this._toggleSetInfo(this._Model.getSetParams(e),e)},_onSetChange:function(t,e){null===this._imagesSet&&this._toggleSetInfo(t,e)},_setImageToView:function(n,s,o){var r,a,l,c,u=this._opts,h=!0===u.resizeView,d=i(e.swfobject,"undefined")?null:e.swfobject,p=n.src;switch((o=this._getViewElement(o)).empty(),n.type){case"pic":"IMG"===o.get(0).tagName?o.attr("src")!==p&&(c=o.clone(!0).attr("src",p),o.replaceWith(c),this._setViewElement(c)):(l={"background-image":"url("+p+")"},h&&"cover"!==o.css("background-size")&&(l["background-size"]=s.width+"px "+s.height+"px"),o.css(l));break;case"flash":if(!d)break;(a=o.children()).length&&(r=a.attr("id"))||(r="flash_pic_"+(new Date).getTime(),t('<div id="'+r+'"></div>').appendTo(o)),d.embedSWF(p,r,s.width,s.height,"9.0.0",null,null,u.flashParams)}return c||o},_prepareViewElement:function(t,e){var n,s=null,i=1;(e=this._getViewElement(e)).css(a);for(var o=r.length;o--&&(n=r[o]);)i=Math.min(i,e[n]()/t[n]);if(i<1)for(s={},o=r.length;o--&&(n=r[o]);)s[n]=Math.round(t[n]*i);return s},_normilizeImageViewElem:function(e,n,i){var o,r=(i=this._getViewElement(i)).get(0),a="IMG"===r.tagName,l="pic"===e&&!a&&n&&!s;return(l||!l&&"pic"!=e&&a)&&(o=t(l?"<img>":"<div>").addClass(r.className),i.replaceWith(o),this._setViewElement(o)),o||i},_processViewSizes:function(t,e,n){(n=this._getViewElement(n)).css(e||a)},_getTargetElement:c,_getViewParent:function(t){return c(this._elems.parent,t)},_getViewElement:function(t){return c(this._elems.imageView,t)},_setViewElement:function(t){this._elems.imageView=t},_showImageVersion:function(t,e){var n=!0===this._opts.resizeView,s=this._prepareViewElement(t,e),i=s||{width:t.width,height:t.height};n&&(e=this._normilizeImageViewElem(t.type,null!==s,e)),e=this._setImageToView(t,i,e),n&&this._processViewSizes(t,i,e),this._zoomInit(e)},_zoomInit:function(t){var e=this._opts,n=e.cssSels,s=e.cssClss.ZoomSlide,i=e.zoom,o=e.attrs.zoom;if(i&&!t.attr(o)){var r=t.closest(n.sliderItem);r.addClass(s);var a=t.parent(),l=t.width(),c=t.height();this._resetZoom(t),t.attr(o,"true"),t.height()>a.height()&&a.css(e.zoomBigImageCss),t.on("touchstart",function(t){2===t.touches.length?(t.stopPropagation(),u.call(this,{scaling:!0,isDoubleFinger:!0,lastDist:this._getZoomDist(t)})):u.call(this,{isDoubleFinger:!1}),h.call(this).scaleSize>1&&(t.stopPropagation(),u.call(this,{isScrolling:!1}),h.call(this).scaling||u.call(this,{clientXprev:t.touches[0].clientX,clientYprev:t.touches[0].clientY}))}.bind(this)),t.on("touchmove",function(e){var n=h.call(this);2===e.touches.length&&(e.preventDefault(),e.stopPropagation(),u.call(this,{isDoubleFinger:!0})),n.scaling&&this._pinchZoomMove(e,t,l,c,a),n.scaleSize>1&&(e.stopPropagation(),u.call(this,{isScrolling:!0}),n.scaling||u.call(this,{scrollLeft:(n.clientXprev-e.touches[0].clientX)/n.scaleSize,scrollTop:(n.clientYprev-e.touches[0].clientY)/n.scaleSize}))}.bind(this)),t.on("touchend",function(n){var s=h.call(this);(s.isScrolling||s.isDoubleFinger)&&n.stopPropagation(),u.call(this,{scaling:!1,scrollTop:0,isScrolling:!1}),setTimeout(function(){r.hasClass(e.cssClss.ActiveSlide)||this._resetZoom(t)}.bind(this),0)}.bind(this))}},_resetZoom:function(t){u.call(this,{scaling:!1,isScrolling:!1,isDoubleFinger:!1,scaleSize:1,scrollLeft:0,scrollTop:0,clientXPrev:0,clientYPrev:0,lastDist:0}),t.css({transform:"scale(1)"})},_getZoomDist:function(t){return Math.round(Math.hypot(t.touches[0].pageX-t.touches[1].pageX,t.touches[0].pageY-t.touches[1].pageY))},_pinchZoomMove:function(t,e,n,s,i){var o=this._opts,r=this._getZoomDist(t),a=h.call(this),l=a.scaleSize,c=o.zoomMinDeltaDist,d=o.zoomSpeed,p=o.maxZoomSize;if(Math.abs(r-a.lastDist)>c){var m=Number((r/(100*d)).toFixed(1)),f=r>a.lastDist?a.scaleSize+m:a.scaleSize-m;if(u.call(this,{scaleSize:f}),f<=1&&this._resetZoom(e),f>p&&u.call(this,{scaleSize:p}),(f=h.call(this).scaleSize)!==l){var g=(n*f-n*l)/2,_=(s*f-s*l)/2;e.css({transform:"scale("+f+")"}),i.scrollLeft((i.scrollLeft()+g)*(1+a.scrollLeft/n)),i.scrollTop((i.scrollTop()+_)*(1+a.scrollTop/s))}}u.call(this,{lastDist:r})},_switchViewState:function(t,e,n){var s=this._opts.cssClss;n=this._getViewParent(n),e=!t&&!0===e,s.Loading&&n.toggleClass(s.Loading,e),s.Error&&n.toggleClass(s.Error,t)},_onImageReady:function(t,e,n,s){this._isTargetImage(n,s)&&(this._switchViewState(!1,!1),this._showImageVersion(t.versions[s]))},_toggleImageInfo:function(t,e){var n=this._opts.cssSels.imageProps,s=this._Model.getImagePropsList(),o=this._elems.imageNum;o&&o.text(e+1),i(n,"object")&&l.call(this,n,t,s)},_toggleSetInfo:function(t,e){var n=o({total:this._Model._getSetImages(e).length},t),s=o({total:this._elems.imagesTotal},this._opts.cssSels.setProps);l.call(this,s,n)},_onImageChange:function(t,e,n){this._isTargetImage(n)&&(this._model.getImage(e,n,this._opts.imagesVersion)||this._switchViewState(!1,!0),this._toggleImageInfo(t,e))},_onImageFail:function(t,e,n){this._isTargetImage(e,n)&&this._switchViewState(!0)},_onImageClick:function(){var t=this._opts;t.useClickHandler&&(i(t.onImgClick,"function")?t.onImgClick.apply(this,arguments):(this._normalizeModelImage(),this._Model.nextImage()))},_isTargetImage:function(t,e){var n=this._imagesSet;return(null===n||t===n)&&(i(e,"undefined")||e===this._imagesVersion)},_normalizeModelImage:function(){var t=this._Model,e=t.getCurrentImage(),n=this._imagesSet;(null!==n&&e.set!=n||null===e.set)&&t.changeSet(n||0),null===e.image&&t.changeImage(0)},_createAdvertManager:function(){return null}}}(),{cssSels:{Main:{imageView:null,imageNum:null,imagesTotal:null},reloadImage:".js-photo_reload",imageProps:null,setProps:null,viewCell:".js-size-reference",sliderItem:".js-slider__item"},cssClss:{Loading:null,Error:null,ActiveSlide:"viewbox__slide_active",ZoomSlide:"viewbox__slide_zoom"},attrs:{zoom:"data-zoom"},useClickHandler:!0,onImgClick:null,infoAppend:{},resizeView:!0,imagesSet:0,imagesVersion:0,flashParams:null,zoom:!1,maxZoomSize:5,zoomSpeed:3,zoomMinDeltaDist:5,zoomBigImageCss:{alignItems:"flex-start"}},null,"ImageView");s.Extend(!0,n,{Modules:{GalleryImageView:r}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},52:function(t,e){!function(t,e){"use strict";var n=e.Basic,s=n.typeOf,i=n.Extend,o=e.Tools.Images,r=n.Constructors.getModel(function(){var e=["title","source","description"],r={};function a(t){this.loading=!0,t&&(this.width=t.width,this.height=t.height)}function l(){delete this.loading}function c(t,e){var n;return"loading"in t||((n=o.canPreload(t.type))?(t.loading=o.preloadImage(t.src,e),t.loading.then(a.bind(t),l.bind(t))):t.loading=n),t.loading}function u(t,e){var n=this._Current;return n.image===t&&n.set===e}function h(t,e){var n,s,i=this._opts.preloadDepth;if(i>0&&u.call(this,t,e)){n=this._getCurrentSetImages();for(var o=t+i;o>=t-i;o--)(s=this._getImageId(o))!=t&&this._startPreload(n[s],s,e)}}function d(t,e,n,s){if(u.call(this,e,n))if(void 0!==s){var i=this._getCurrentSetImages();this._trigger("imageready",i[e],e,n,t)}else this._trigger("imagefail",e,n,t)}function p(t){if(Array.isArray(t))for(var e=0;e<t.length;e++)this.addImagesSet(t[e]);else s(t,"object")&&this.addImagesSet(t)}function m(t,e,n){var s,r=t.split(e),a=r[2],l={src:r[0],type:a};return a&&o.isTypeCorrect(a)||(l.type=a=o.getImageTypeFromUrl(r[0])||n),a?(s=r[1])&&(s=s.split("x")).length>1&&i(l,{width:1*s[0],height:1*s[1]}):l=null,l}function f(t){var e,n,o=[],r=this._opts.urlSeparator,a=this._opts.imageType;Array.isArray(t)||(t=[t]);for(var l=0;l<t.length;l++)e=t[l],(n=s(e,"object")?i({type:a},e):s(e,"string")&&e.length>0?m(e,r,a):null)&&o.push(n);return o}function g(t){for(var e,n,i,o,r,a,l=[],c=this.getImagePropsList(),u=0;u<t.length;u++){if(e=t[u],o={},s(e,"object")){n=e.url||e.image;for(var h=c.length;h--;)i=c[h],e.hasOwnProperty(i)&&(o[i]=e[i]);"source"in o&&(a=void 0,a=(r=o).source,s(a,"object")&&(r.source=a=[a.name,a.href]),s(a,"string")&&(r.source=a=a.split("|")),Array.isArray(a)&&a[0]||delete r.source)}else n=e;(n=f.call(this,n)).length&&(o.versions=n,l.push(o))}return l}function _(t,e,n,s){for(var i=this._isValidId(s),o=t.length;o--;){var r=d.bind(this,i?s:o,e,n);t[o].then(r,r)}}return{_Events:["setchange","setimageschange","imagechange","imageready","imagefail","imageloaded","imageloading","lastimage","message"],_Init:function(t){var n,s=this._opts.imageProps,o=this._aImageProps=e.slice(0);if(this._setsParams=[],this._setsImages=[],this._Current={set:null,image:null},Array.isArray(s))for(var r=s.length;r--;)n=s[r],-1===o.indexOf(n)&&o.push(n);if(t&&t.images)p.call(this,t);else if(t&&t.imageSets){var a=i({},t);p.call(this,a.imageSets)}},_getSetImages:function(t){var e=this._setsImages,n=null;return null===t&&(t=this._Current.set),this._isAvailableId(t,e)&&(n=this._setsImages[t]),n},_preloadCurImage:function(t,e){var n=this._Current.set,s=this._startPreload(e,t,n),i=h.bind(this,t,n);return _.call(this,s,t,n),Promise.all(s).then(i,i)},_startPreload:function(t,e,n,s){for(var i,o,r,a=this._opts.preloadTimeout,l=t.versions,u=[],h=0;h<l.length;h++)this._isValidId(s)&&h!==s||(r=!("loading"in(o=l[h])),i=Promise.resolve(c(o,a)),r&&(this._trigger("imageloading",t,e,n,h),i.then(this._trigger.bind(this,"imageloaded",t,e,n,h))),u.push(i));return u},_getImageId:function(t){var e,n=this._getCurrentSetImages(),s=(n&&n.length||0)-1;return!0===this._opts.Loop?(t%=e=s+1)<0&&(t+=e):t=Math.max(0,Math.min(t,s)),t},_isValidId:function(t){return null!==t&&!isNaN(t)},_isAvailableId:function(t,e){return this._isValidId(t)&&t in e},_getCurrentSetImages:function(){return this._getSetImages(null)},_getCurrentSetParams:function(){return this.getSetParams(null)},getImageParams:function(t,e){return t=isNaN(t)?this._Current.set:+t,e=isNaN(e)?this._Current.image:+e,n.getByPath([t,e],this._setsImages)},getCurrentImageParams:function(){return this.getImageParams(this._Current.set,this._Current.image)},reloadImage:function(t,e,n){var s;this._isValidId(n)||(n=this._Current.set),this._isAvailableId(t,this._getCurrentSetImages())&&(s=this._startPreload(this.getImageParams(n,t),t,n,e),_.call(this,s,t,n,e))},addImagesSet:function(e){var n=e&&e.images,s=-1;if(Array.isArray(n)){var i=this._setsImages;s=i.length,(n=g.call(this,n,s)).length?(i.push(n),this._setsParams[s]=e):s=-1}return t.DEBUG&&-1===s&&t.console.warn("Новый сет изображений не добавлен:",e),s},addImages:function(t,e,n){var s=this._setsImages,o=!0;null===(e=this._isAvailableId(e,s)?e:this._Current.set)&&(e=this.addImagesSet({images:t}),o=!1);var r,a,l,c=s[e],u={imagesAdded:!1};return Array.isArray(t)&&(l=(t=g.call(this,t,e)).length)&&(n?(r="unshift",u.indexFirst=0,u.indexLast=l-1):(r="push",a=c.length,u.indexFirst=a,u.indexLast=a+l-1),o&&Array.prototype[r].apply(c,t),i(u,{imagesAdded:!0,setLength:c.length,setId:e,newImages:t}),this._trigger("setimageschange",u)),u},changeSet:function(t){var e=this._Current,n=this._isAvailableId(t,this._setsImages)&&t!=e.set;return n&&(e.set=1*t,e.image=null,this._trigger("setchange",this._setsParams[t],t)),n},changeImage:function(t){var e,n,s,i=this._Current,o=this._getCurrentSetImages(),r=!1;return o&&this._isValidId(t)&&(t=+t,(r=(t=this._getImageId(t))!=i.image)&&(i.image=t,e=o[t],this._trigger("imagechange",e,t,i.set),!0!==this._opts.Loop&&(s=0===t,((n=t===o.length-1)||s)&&this._trigger("lastimage",n,s)),this._preloadCurImage(t,e))),r},nextImage:function(){return this.changeImage(this._Current.image+1)},prevImage:function(){return this.changeImage(this._Current.image-1)},getImagePropsList:function(){return this._aImageProps.slice(0)},getCurrentImage:function(){var t=this._Current,e=this._getCurrentSetImages();return{image:t.image,set:t.set,setLength:e&&e.length||0}},getImageProps:function(t,e){var n=this._Current,s=this._setsImages,o=null,r=this._isValidId,a=this._isAvailableId.bind(this);return t=r(t)?t:n.image,a(e=r(e)?e:n.set,s)&&a(t,s[e])&&delete(o=i(!0,{},s[e][t])).versions,o},getImage:function(t,e,n){var i=this._Current,o=!1;if(!this._isAvailableId(e,this._setsImages)&&null===(e=i.set))return null;var r=this._setsImages[e];this._isAvailableId(t,r)||(t=i.image);var a=r[t];return a&&this._isAvailableId(n,a.versions)&&(o=s(a.versions[n].loading,"boolean")),o?a:null},getSetParams:function(t){var e=this._setsParams,n=null;return null===t&&(t=this._Current.set),this._isAvailableId(t,e)&&(n=i(!0,{},e[t])),n},addToCache:function(e,n){n?r[n+""]=e:t.DEBUG&&t.console.error("Для кэширования данных необходимо имя ключа!")},getFromCache:function(t){return r[t+""]},postMessage:function(t){this._trigger("message",t)}}}(),{_Handlers:null,preloadDepth:null,preloadTimeout:2e4,Loop:!1,imageProps:null,urlSeparator:"|",imageType:"pic"},null,"Gallery");i(t.getNameSpace("Modules",e),{Gallery:r})}(window,window.ru.mail.cpf)},53:function(t,e){var n,s,i,o,r,a;window.jQuery||window.$,window,n=window.ru.mail.cpf,s=n.Basic,i=s.Extend,o=s.typeOf,r=s.getOptions,a=s.Constructors.getView(function(){function t(t){for(var e,n,s,i,a,l,c=this._opts,u=c.Attrs,h=this._Model.getImagePropsList(),d=u.imageVersions,p=u.imageProps,m=[],f=null,g=0;g<d.length;g++){a=d[g].split("|");for(var _=0;_<a.length;_++)if(e=t.getAttribute(a[_])){m.push(e);break}}if(m.length&&(f={url:m},o(p,"object")))for(var v=h.length;v--;)(s=p[n=h[v]])&&(i=t.getAttribute(s))&&(f[n]=i);if(c.useOnclickData)for(var w in l=r(t))l.hasOwnProperty(w)&&-1!==h.indexOf(w)&&(f[w]=l[w]);return f}return{_Events:["previewClick"],_Handlers:{dom:{"click:Main.Preview":"_onPreviewClick"},model:{imagechange:"_onImageChange"}},_Init:function(){var t,e,n=this._opts,s=this._Elems.Preview,o=this._Model,r=n.imagesSet;this._imagesSet=r,s&&s.length&&(t=this.getImagesFromElems(s)).length&&(null!==r?o.addImages(t,r):(e=i({images:t},n.addSetParams),this._imagesSet=this._Model.addImagesSet(e)))},getSetId:function(){return this._imagesSet},getImagesFromElems:function(e){return e.toArray().map(t.bind(this)).filter((function(t){return null!==t}))},_onPreviewClick:function(t){var e=t.currentTarget,n=this._opts.Attrs.imageId,s=this._opts.Attrs.imageSetId,i=e.getAttribute(n)||this._elems.Preview.index(e),o=e.getAttribute(s)||this._imagesSet;this._model.changeSet(o),this._model.changeImage(i),this._trigger("previewClick",{imageId:i,imageSetId:o}),t.preventDefault()},_onImageChange:function(t,e,n){var s=this._opts.cssClss.currentPreview,i=this._imagesSet,o=this._Elems.Preview;o&&(null===i||n===i)&&s&&o.removeClass(s).eq(e).addClass(s)}}}(),{cssSels:{Main:{Preview:".js-preview-list__item"}},cssClss:{currentPreview:null},Attrs:{imageVersions:null,imageProps:null,imageId:"data-image-id",imageSetId:"data-image-set"},imagesSet:null,addSetParams:null,useOnclickData:!1},null,"GalleryPreviews"),s.moduleOpts.setParams("GalleryPreviews",{acceptTypes:"Gallery"}),i(!0,n,{Modules:{GalleryPreviews:a}})},54:function(t,e){!function(t,e,n){var s=n.Basic,i=s.typeOf,o=e.getNameSpace("Modules",n),r=t(e),a=t(e.document),l=n.Modules.GalleryImageView,c=s.moduleOpts.setParams,u=s.Constructors.getView(function(){var o=["width","height"];function l(e,n){var s,o,r;switch(i(e)){case"object":r=e instanceof t;case"array":if(e.length>1)for(var a=e.length;a--;)o=l(r?e.eq(a):e[a],n),s&&s>o||(s=o);else s=r?e[n]():l(e[0],n);break;case"number":s=e;break;case"function":s=e()}return s}function c(t,e){var n,s,i={};e=!0===e;for(var r=o.length;r--;)s=n=o[r],e&&(s="outer"+n.charAt(0).toUpperCase()+n.substring(1)),i[n]=t[s]();return i}function h(e,n){var i,o,r=this._opts.cssSels.sizeReference,a=this._elems,l=s.Extend({visibility:"hidden"},e),c=a.sizeReference;if(!r||c&&c.length||(c=n.parents(r).first()),c&&c.length)n.css(l);else{i=n.parents(),o=[];var u=i.filter((function(){var e="visible"!==t(this).css("overflow");return e&&o.push(this.scrollWidth-this.offsetWidth+this.scrollHeight-this.offsetHeight),e}));n.css(l),c=u.filter((function(t){return o[t]<this.scrollWidth-this.offsetWidth+this.scrollHeight-this.offsetHeight})).first().children().filter(i),a.sizeReference=c}return c}function d(t){t=this._getViewElement(t);for(var e,n,s,i=this._opts.sizeLimits,u=c(r),d=c(h.call(this,u,t),!0),p={},m=o.length;m--;)e=o[m],s=Math["width"===e?"max":"min"](u[e],a[e]()),s-=d[e]-u[e],i&&i.hasOwnProperty(e)?(n=l(i[e],e),n=Math.max(n,s)):n=s,p[e]=n;return t.css({visibility:""}),p}function p(t,e){for(var n,s=d.call(this,e),i=null,r=1,a=o.length;a--&&(n=o[a]);)r=Math.min(r,s[n]/t[n]);if(r<1)for(i={},a=o.length;a--&&(n=o[a]);)i[n]=Math.round(t[n]*r);return i}function m(t){this._elems.sizeCont&&this._elems.sizeCont.width(""),u.prototype._parent._showImageVersion.apply(this,t)}return{_Handlers:{"dom:keydown:document":function(t){var e=t.keyCode,n=this._Model;this._state.visible&&(37===e?n.prevImage():39!==e&&32!==e||n.nextImage())},model:{setchange:function(t){t.hasOwnProperty("showBanner")&&!!t.showBanner!==this._opts.showBanner&&this.addOptions({showBanner:!!t.showBanner})}}},_Events:["show","hide"],_parentElement:function(){var e=null,n=this._opts;return i(n.templates.block,"function")&&(e=t(n.templates.block.call(this,n.templatesData.block||{}))),e},_Init:function(){this._state=s.Extend(!0,this._state||{},{visible:!1}),this._popup=null,this._elems.sizeCont||!1===this._opts.setContSize||(this._elems.sizeCont=this._elems.parent)},_prepareViewElement:function(t,e){var n;return this._state.visible&&(this._hideBanner(),n=p.call(this,t,e)),n},_switchViewState:function(t,e){e=!t&&!0===e,this._state.visible&&(u.prototype._parent._switchViewState.apply(this,arguments),!1!==this._opts.usePopupLoading&&(e?this._popup.getOverlay().showLoading():this._popup.getOverlay().toggleBlock(this._elems.parent)))},_onImageReady:function(t,e,n,s){this._isTargetImage(n,s)&&(this._state.image=t.versions[s],this._state.visible&&(this._resetReadyStateFor(t.versions[this._opts.imagesVersion]),this._opts.showBanner&&this._showBanner(),u.prototype._parent._onImageReady.apply(this,arguments)))},_onImageChange:function(t,n,s){var i=!0===this._opts.showOnChange,o=this._state,r=o.visible;this._isTargetImage(s)&&(delete o.image,e.cancelAnimationFrame(o.showRequest),r?u.prototype._parent._onImageChange.apply(this,arguments):i&&this.Show())},_initPopup:function(){this._popup=n.Tools.initModule(["Popup",this._opts.popupExt],this._elems.parent,{_Handlers:{show:this._onPopupToggle.bind(this,!0),hide:this._onPopupToggle.bind(this,!1)}})},_getPopupInstance:function(){var t=this._popup;return t||(this._initPopup(),t=this._popup),t},_onPopupToggle:function(t){var e,n,s,i=this._state,o=this._Model;i.visible=t,t?(n=(e=o.getCurrentImage()).image,s=e.set,this._toggleSetInfo(o.getSetParams(s),s),this._toggleImageInfo(o._getCurrentSetImages()[n],n),"image"in i?this._showCurrentImage():this._switchViewState(!1,!0)):this._clearImageView(),this._trigger(t?"show":"hide")},_showCurrentImage:function(){this._showImageVersion(this._state.image)},_clearImageView:function(){this._getViewElement().empty()},_showImageVersion:function(){this._state.showRequest=e.requestAnimationFrame(m.bind(this,Array.prototype.slice.call(arguments)))},_processViewSizes:function(t,e){u.prototype._parent._processViewSizes.apply(this,arguments),this._elems.sizeCont&&this._elems.sizeCont.width(e.width)},_onImageClick:function(){this._normalizeModelImage(),this._model.nextImage()||this._getPopupInstance().hide()},_hideBanner:function(){var t=this._popup.getOverlay();t&&t.hideBanner&&t.hideBanner(this._opts.bannerId)},_showBanner:function(){if(this._opts.showBanner){var t=this._popup.getOverlay();t&&t.showBanner&&t.showBanner(this._opts.bannerId,!0)}},isVisible:function(){return!0===this._state.visible},Show:function(){this._normalizeModelImage(),this._getPopupInstance().show()},Hide:function(){this._getPopupInstance().hide()},showLoading:function(){this._getPopupInstance().getOverlay().showLoading()},addOptions:function(t){return i(t,"object")&&s.Extend(!0,this._opts,t),this}}}(),{cssSels:{sizeReference:null,Main:{sizeCont:null}},showOnChange:!1,showBanner:!0,sizeLimits:null,setContSize:!0,templates:{block:null},templatesData:{block:null},imagesVersion:1,imagesSet:null,Banner:null,bannerId:"default",usePopupLoading:!1,popupExt:"ImageView"},l,"PopupGalleryView");s.Constructors.getView({_Handlers:{"dom:click:showPopup":"_onShowClick"},_onShowClick:function(t){t.preventDefault();var e=this.getPopup();e&&e.Show()},getPopup:function(){var t=this._popupView;return t||(this._popupView=t=this._elems.Parent.data("PopupGalleryView")),t}},{cssSels:{showPopup:".js-show_photo"}},null,"ShowGalleryPopup"),c("ShowGalleryPopup",{acceptTypes:"Gallery"}),c("PopupGalleryView",{initializer:function(t,e,n){return new u(t,null,n)},acceptTypes:"Gallery"}),o.PopupGalleryView=u}(window.$,window,window.ru.mail.cpf)},55:function(t,e){var n,s,i,o;window.$,window,n=window.ru.mail.cpf,i=n.Tools.initModule,o={usePopupLoading:!1,bannerExt:"PopupGalleryView"},n.Basic.Constructors.addPlugin("PopupGalleryView",{_Init:function(){this._elems.sizeCont=null},_onImageLoaded:function(){this._state.visible&&this._super.apply(this,arguments)},_onImageChange:function(t,e,n){var s;this._isTargetImage(n)&&!this._state.visible&&this._opts.showOnChange&&(this.Show(),s=this._getImageFrames(e),this._slider.goToFrame(s.frame,!0)),this._super.apply(this,arguments)},_onPopupToggle:function(t){t&&(this._slider.update(!0,!1,!0),this._state.sliderSize=this._getSliderSizes()),this._super.apply(this,arguments),this._advertManager&&this._advertManager.reset()},_showCurrentImage:function(){var t=this._model.getCurrentImage().image;this._replaceImageFrames(t),this._slider.goToFrame(t,!0),this._super.apply(this,arguments)},_clearImageView:function(){var t,e=this._model.getCurrentImageParams();e&&(t=e.versions[this._opts.imagesVersion])&&delete this._state.imagesReady[t.src],this._super.apply(this,arguments)},_showBanner:function(){if(this._opts.showBanner){var t=this._model.getCurrentImage(),e=t&&this._getImageFrames(t.image);if(e){var n=this._model.getCurrentImageParams(),o=i(["Banner",this._opts.bannerExt],e.frame,null,null,[{instance:(s||(s=i("BannerController")),s),type:"BannerController"}]);this._resetReadyStateFor(n.versions[this._opts.imagesVersion]),o&&o.show()}}}},o,"PopupImageSlider")},56:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.Constructors.addPlugin,i=n.Basic.Extend,o=n.Basic.debounce,r={cssSels:{Main:{slider:".js-image-slider"},slideContents:null},templates:{frames:n.Tools.getTemplate("ct-viewbox-slides.xml"),frameContents:n.Tools.getTemplate("ct-viewbox-slide-content.xml")},imageSliderExt:"ImageView"};s("ImageView",function(){function s(t,e,n){this._switchViewState(!1,!1,n.all),this._showImageVersion(t.versions[e],n.contents.find(this._opts.cssSels.Main.imageView))}function r(t){t=t||this._model._getCurrentSetParams();var e=this._opts.imagesVersion;return{params:t,images:(this._model._getCurrentSetImages()||[]).map((function(t){return i({},t,{targetVersion:t.versions[e]})}))}}var a=function(t){var n=e.document.createElement("div"),s=r.call(this,t);n.innerHTML=this._opts.templates.frames(s),this._state=i({},this._state,{setImages:s,imageFrames:[],framesContent:[],imagesReady:{}}),this._slider.replaceFrames(n.children,0)};return{_Handlers:{model:{setchange:a,imageloaded:"_onImageLoaded",imageloading:function(t,e,n,s){var i=this._getImageFrames(e);this._isTargetImage(n,s)&&i&&this._switchViewState(!1,!0,i.all)}},dom:{"resize:window":o((function(){this._state&&(this._state.sliderSize=this._getSliderSizes())}),100)}},_Init:function(){this._slider=n.Tools.initModule(["Slider",this._opts.imageSliderExt],this._elems.slider||this._elems.parent,{_Handlers:{beforeSlide:function(t){this._advertManager&&this._advertManager.beforeSlide(t)||this._replaceImageFrames(null,t)}.bind(this),slide:function(t){null!=(t=this._advertManager?this._advertManager.slide(t):t)&&(this._model.changeImage(t),this._replaceImageFrames(t,null))}.bind(this),swipeEnd:function(){this._state.sliderSwipe=!1}.bind(this),swipeStart:function(){this._state.sliderSwipe=!0}.bind(this),slideControlTap:function(){this._state.sliderTap=!0}.bind(this)}}),this._state=i(this._state||{},{imageFrames:[],setImages:r.call(this),sliderSwipe:!1,sliderTap:!1,sliderSize:this._getSliderSizes(),imagesReady:{}}),this._advertManager=this._createAdvertManager(),a.call(this)},_replaceImageFrames:function(t,e){var n,i,o,r=this._opts,a=this._model.getCurrentImage(),l=a.setLength,c=r.cssSels.slideContents,u=null!==t,h=r.imagesVersion;u&&(n=t-2,i=t+2);for(var d=0;d<l;d++){var p=this._getImageFrames(d),m=u&&d>=n&&d<=i||d===e;if(m)if("contents"in p){if((o=(o=this._Model.getImageParams(null,d))&&o.versions[h])&&"iframe"===o.type){var f=p.contents.find(r.cssSels.Main.imageView);f.length&&"IMG"!==f.prop("tagName")&&!f.children().length&&f.append(this._Model.getFromCache(o.src))}o=null}else p=this._getFramesWithContents(d,p);var g=p.contents,_=p.all,v=g&&g.parent().length>0;m&&!v?(c&&(_=c.find(c)),g.each((function(t){_.eq(t).append(this)})),(o=this._model.getImage(d,a.setId,h))&&s.call(this,o,h,p)):u&&!m&&v&&g.detach()}},_getSliderSizes:function(){var t=this._elems.slider||this._elems.parent;return{width:t.width(),height:t.height()}},_getImageFrames:function(t){var e=this._state.imageFrames[t];return e||((e={frame:this._slider.getFrameByNo(t)}).clones=this._slider.getFrameClones(e.frame),e.all=e.frame.add(e.clones),this._state.imageFrames[t]=e),e},_getFramesWithContents:function(n,s){null==s&&(s=this._getImageFrames(n));var o=s.contents;if(!o){var r=this._opts.templates.frameContents,a=i({image:n},this._state.setImages),l=e.document.createElement("div");l.innerHTML=r(a),o=t(Array.from(l.childNodes)).detach();for(var c=0;c<s.all.length;c++)c>0&&(o=o.add(o.eq(0).clone()));s.contents=o}return s},_onImageClick:function(){this._state.sliderSwipe||this._super.apply(this,arguments)},_onImageLoaded:function(t,e,n,i){var o=this._model.getCurrentImage().image;if(this._isTargetImage(n,i)&&e!==o){var r=this._getFramesWithContents(e);r.contents.parent().length||this._replaceImageFrames(o,e),s.call(this,t,i,r)}},_onImageChange:function(t,e,n){var s;this._isTargetImage(n)&&(this._replaceImageFrames(null,e),e!==this._slider.getFrameNo()&&(s=this._getImageFrames(e),this._slider.goToFrame(s.frame))),this._super.apply(this,arguments)},_getViewElement:function(t){var e=this._slider.getCurrentFrame().find(this._opts.cssSels.Main.imageView);return this._getTargetElement(e,t)},_setViewElement:function(){},_getViewParent:function(t){return this._getTargetElement(this._slider.getCurrentFrame(),t)},_showImageVersion:function(t){var e=this._state.imagesReady[t.src],n=this._state.sliderSize;e&&e.height===n.height&&e.width===n.width||(this._super.apply(this,arguments),this._state.imagesReady[t.src]=i({},n))},_resetReadyStateFor:function(t){delete this._state.imagesReady[t.src]},_toggleImageInfo:function(){}}}(),r,"ImageViewSlider")}(window.$,window,window.ru.mail.cpf)},57:function(t,e){!function(t,e){"use strict";var n=t.history,s=e.Basic,i=s.typeOf,o=t.document.title,r=t.location.href;function a(t){var e=this._trigger.bind(this);i(t,"string")&&setTimeout((function(){n.replaceState(null,o,t),e("urlchange",t)}),1)}function l(t,e){var n=this._opts.urlReplace,s=t[n.urlProp],i=s&&"#"!==s?s:r;n.canReplace&&(a.call(this,i),n.changeOriginalUrl&&0===e&&(r=i))}n.replaceState&&s.Constructors.addPlugin("PopupGalleryView",{_Events:["urlchange"],_Handlers:{model:{imagechange:function(t,e,n){this._isTargetImage(n)&&this._state.visible&&l.call(this,t,n)}},hide:function(){this._opts.urlReplace.canReplace&&a.call(this,r)},show:function(){this._opts.urlReplace.canReplace&&l.call(this,this._Model.getImageProps(),0)}}},{urlReplace:{urlProp:"share_url",canReplace:!0,changeOriginalUrl:!1}},"UrlReplace")}(window,window.ru.mail.cpf)},576:function(t,e,n){n(198),n(101),n(100),n(214),n(375),n(253),n(577),n(580),n(79),n(92),n(255),n(256),n(239),n(240),n(581),n(187),n(345),n(346),n(347),n(44),n(582),n(376),n(257),n(258),n(218),n(29),n(219),n(220),n(259),n(583),window.ru.mail.asyncTemplates.prefetch("/bem/web/web.bundles/ct-popup-vendors/ct-popup-vendors.xml.js")},577:function(t,e,n){n(578),n(579)},578:function(t,e){!function(t,e,n,s){"use strict";var i=s.prefixed("transform"),o=s.csstransforms,r=e.requestAnimationFrame,a=e.MutationObserver,l=n.Basic.getView,c=n.Tools.FuncTools.multi,u=t(e),h={cssSels:{Main:{panel:".js-fixed-panel"}},cssClss:{base:"m-fixed-panel",top:"m-fixed-panel_top",bottom:"m-fixed-panel_bottom",fixed:"m-fixed-panel_fixed",absolute:"m-fixed-panel_absolute"},offset:{top:20,bottom:20},documentElement:e.document},d=o?function(t,e){return t.css(i,"translate(0, "+e.y+"px)")}:function(t,e){return t.css({top:e.y})};function p(){return e.pageYOffset||document.documentElement.scrollTop}var m=function(t,e){var n,s,i=this._opts.cssClss,o={},r=this._elems.panel;return o[i.base]=!0,o[i.absolute]=0===t||2===t,o[i.fixed]=-1===t||1===t,o[i.top]=1===t,o[i.bottom]=-1===t,this._state.position=t,n=r,s=o,Object.keys(s).forEach((function(t){n.toggleClass(t,s[t])})),r.css("left",o[i.fixed]?r.parent().offset().left-document.body.scrollLeft:""),d(r,{y:e}),this._elems.panel},f=c((function(t,e){return t?e?"fullDown":"fullUp":"small"})).method("small",(function(){var t=m.bind(this),e=this._opts.offset,n=this._state.bounds.parent,s=this._state.bounds.panel,i=p.call(this),o=i+e.top<n.offset.top,r=n.rect.height+n.offset.top-i>s.rect.height+e.top;o?t(-2,0):r?t(1,e.top):t(2,n.rect.height-s.rect.height-e.bottom)})).method("fullDown",(function(t,e,n,s){var i=m.bind(this),o=this._opts.offset,r=this._state.height,a=this._state.bounds.parent,l=this._state.bounds.panel,c=a.rect.top<=o.top&&a.rect.bottom<=r,u=a.rect.top<o.top&&a.rect.bottom>r&&l.rect.bottom<=r;1===s?i(0,l.rect.top-a.rect.top-o.bottom):c?i(2,a.rect.height-l.rect.height-o.bottom):u&&i(-1,0)})).method("fullUp",(function(t,e,n,s){var i=m.bind(this),o=this._opts.offset,r=this._state.height,a=this._state.bounds.parent,l=this._state.bounds.panel,c=a.rect.top>o.top-o.bottom,u=a.rect.top<=0&&a.rect.bottom>=r&&l.rect.top>o.top&&l.rect.bottom>=r;-1===s?i(0,l.rect.top-a.rect.top-o.bottom):c?i(-2,0):u&&i(1,o.top)})),g=function(){var t=p.call(this),e=this.getBounds(),n=t>=this._state.value,s=e.panel.rect.height+this._opts.offset.top>u.height();this._state.value=t,this._state.bounds=e,r(f.bind(this,s,n,t,this._state.position))},_=function(){var t=this._state.bounds,e=this.getBounds();t.parent.rect.height===e.parent.rect.height&&t.panel.rect.height===e.panel.rect.height||g.call(this)};l({_Init:function(){var t=this,n=new a((function(){_.call(t)}));null!==this._elems.panel?(this._state={position:-2,value:p.call(this),height:u.height()},u.on("scroll",(function(e){e.target==t._opts.documentElement&&g.call(t)})),u.on("resize",(function(){t._state.height=u.height(),g.call(t)})),n.observe(this._elems.panel.get(0),{subtree:!0,childList:!0}),g.call(this)):e.console.error('Ошибка инициализации, не найден контейнер блока "'+this._elems.parent+'"')},getBounds:function(){var t=this._elems,e=t.parent,n=t.panel;return{parent:{rect:e.get(0).getBoundingClientRect(),offset:e.offset()},panel:{rect:n.get(0).getBoundingClientRect(),offset:n.offset()}}}},h,null,"FixedPanel")}(window.jQuery,window,window.ru.mail.cpf,window.Modernizr)},579:function(t,e){!function(t){"use strict";var e=window.ru.mail.cpf.Basic.moduleOpts.setParams;e("FixedPanel",{options:{offset:{top:20}}}),e("FixedPanel.ArticleMenu",{options:{_Handlers:{pubsub:{"stickyPanel.articlePanel.change":function(t){var e=t.data;0===e.currState?this._opts.offset.top=20:-1===e.currState&&(this._opts.offset.top=75)}}},offset:{top:75}}})}()},58:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=s.typeOf,o=n.Types.String.Url.addParams,r=n.Tools.transport,a=["loadStart","loadFinish","loadError","showSplash","splash"];s.Constructors.addPlugin("Gallery",{_Handlers:{setchange:"_onSetChange"},_Init:function(){this._resetSplashFlags(),this._galleriesCache={},this._addEventTypes(a),this._Current.galleryId=this._opts.galleryId||null},setSplashUrl:function(t){this._opts.urlSplash=t,this._resetSplashFlags()},addImagesSet:function(){var t=this._super.apply(this,arguments);return-1!==t&&(this._setsParams[t].addLastFrame=!0),t},changeImage:function(t){var e=this._getCurrentSetImages();if(!e||!this._isValidId(t))return!1;var n,s,i,o=this._opts,r=this._Current,a=!!o.Loop,l=this._opts.gallerySplashCount,c=null===l;t=+t;var u=this._getImageId(t),h=e[u];c?i=(s=this._showSplash&&t===e.length)||!this._showSplash&&u===e.length-1:(s=this._showSplash&&t>=e.length,i=l>0?s&&t===e.length-1+l:u===e.length-1);var d=0===u;return(n=t<=e.length+l?(s?t:u)!=r.image:a&&u!==r.image)&&(s?(r.image=t,this.getSplashData().then(this._trigger.bind(this,"splash")),this._trigger("showSplash",l?{imageId:t}:{})):(r.image=u,this._trigger("imagechange",h,u,r.set),this._preloadCurImage(u,h),this._showSplash&&o.preloadSplash&&!this._splashDataPromise&&this.loadSplash().then(function(t){this._showSplash=!!t||o.showSplash}.bind(this)))),a||!i&&!d||this._trigger("lastimage",i,d),n},getSplashData:function(t){return this._splashDataPromise||this.loadSplash(t)},loadSplash:function(n){n=i(n,"undefined")?this._Current.galleryId:n;var s,a=this._opts,l=this._trigger.bind(this),c=a.urlSplash;if(c){var u=i(a.getUrlParams,"function")?a.getUrlParams.call(this,n):{};u=t.extend({},a.urlParamsStatic.splash||{},u),a.randomUrlParam&&(u[a.randomUrlParam]=(Math.random()+"").split(".")[1]),s=r({url:o(u,c)})}else s=Promise.resolve();return this._trigger("loadStart","splash",n),this._splashDataPromise=s.then((function(t){return l("loadFinish","splash",n),t})).then(function(t){return i(a.prepareSplashData,"function")&&(t=a.prepareSplashData.call(this,t)),t}.bind(this)).catch((function(t){e.console.error(t),l("loadError","splash",n)})),this._splashDataPromise},loadGallery:function(n){var s=this._opts,i={},a=null;return s.useGalleriesCache&&(a=(this._galleriesCache[n]||{}).storage),i[s.urlParams.galleryId]=n,this._trigger("loadStart","gallery",n),(a?Promise.resolve(a):r({url:o(t.extend({},s.urlParamsStatic.gallery,i),s.urlGallery)}).then((function(t){return t})).catch(function(t){e.console.error(t),this._trigger("loadError","gallery",n)}.bind(this))).then(function(t){return this._onGetGalleryInfo(n,t),t}.bind(this))},_getImageId:function(t){var e,n=this._getCurrentSetImages(),s=n&&n.length-1||0;return!0===this._opts.Loop?(t%=e=s+1)<0&&(t+=e):t=Math.max(0,Math.min(t,s)),t},_onGetGalleryInfo:function(t,e){var n=this._opts,s=this._galleriesCache,o=(s[t]||{}).setId;isNaN(o)&&(i(n.prepareGalleryData,"function")&&n.prepareGalleryData.call(this,e),o=this.addImagesSet(e),s[t]={setId:o,storage:e}),this._trigger("loadFinish","gallery",o,e),this.changeSet(o)&&this.changeImage(0)},_resetSplashFlags:function(){this._showSplash=!!this._opts.urlSplash||this._opts.showSplash,this._splashDataPromise=null},_onSetChange:function(t){this._resetSplashFlags(),t.id&&(this._Current.galleryId=t.id)}},{showSplash:!1,galleryId:null,urlSplash:null,urlGallery:null,urlParams:{galleryId:"id"},urlParamsStatic:{splash:null,gallery:null},getUrlParams:null,randomUrlParam:"",useGalleriesCache:!0,preloadSplash:!1,prepareGalleryData:null,prepareSplashData:null,gallerySplashCount:null},"Ajax")}(window.$,window,window.ru.mail.cpf)},580:function(t,e,n){n(342),n(343),n(344)},581:function(t,e,n){!function(t,e,n){"use strict";var s=n.Basic;var i=function e(s){var i=this._opts,o=i.attrs,r=s.filter((function(t,e){return!e.getAttribute(o.activated)}));if(r.length){r.attr(o.activated,"1");var a=r.find(this._opts.cssSels.lazyEmbed);a.length&&(a.each((function(t,e){-1!==i.embedTypesToWatch.indexOf(e.getAttribute(o.type))&&r.eq(t).attr(o.resizable,1)})),c.call(this,a.eq(0).parent()),n.Tools.activateEmbeds(a,{closestParent:".js-slider__item"}).forEach(function(n){n.then(function(){this.update()}.bind(this),function(n){t(n.element).remove(),this.update(!0).then(function(){e.call(this,h.call(this,this.getPageNo()))}.bind(this))}.bind(this))}.bind(this)))}},o=function(){var t=0,e=u.call(this);e.length&&e.each((function(e,n){t=Math.max(t,n.offsetHeight)})),t&&this._Elems.content.height(t)},r=function(t){var e=0;return t.each((function(t,n){e=Math.max(e,n.offsetHeight)})),e},a=function(t){return r.call(this,u.call(this,t))||0},l=function t(e){var n=this._State;if(clearTimeout(n.watchTimeoutId),e&&e.length&&e.parent().length){var s=r(e);n.frameHeight!==s&&(n.frameHeight=s,o.call(this)),n.watchTimeoutId=setTimeout(t.bind(this,e),this._opts.checkHightTimeout)}},c=function(t,e){e||(e=[1e3,1500,2e3,3e3,5e3,1e4]);var n=a.bind(this),s=n(),i=t.trigger.bind(t,"documentHeightChange"),o=this.update.bind(this);e.forEach((function(t){setTimeout((function(){var t=n();t!==s&&(o(),i(),s=t)}),t)}))},u=function(e,n){isNaN(e)&&(e=this.getPageNo());var s=this.getPages(),i=t(s[e]&&s[e].frames),o=this._opts.attrs.resizable;return n&&(i=i.filter((function(t,e){return!!e.getAttribute(o)}))),i},h=function(e,n){e=e||0,n=n||2;for(var s=t(),i=u.bind(this),o=e+n,r=Math.max(0,e-n);r<=o;r++)s=s.add(i(r));return s},d=function(t){var e,n=this._Elems,s=this._State,i=Math.max(a.call(this,t),this._opts.minItemHeight),o=!1,r=!1,l=(s.frameHeight||0)/2,c=s.controlHeight,u=this._opts.cssClss.animatedControl;"buttonsTopShift"in s||(l<5&&(l=this._Elems.container.height()/2),n.shiftedButtons=n.controlNext.add(n.controlPrev),n.shiftedButtons.removeClass(u),s.buttonsTopShift=n.shiftedButtons.get(0).offsetTop+c/2,o=r=!0),i&&l>i-c&&(e=Math.max(i,c)/2)<s.buttonsTopShift&&(s.buttonsTopShift=e,o=!0),s.buttonsTopShift<c/2&&(s.buttonsTopShift=c/2),o&&(n.shiftedButtons.css({top:s.buttonsTopShift}),r&&n.shiftedButtons.addClass(u))};s.Constructors.addPlugin("Slider",{_Handlers:{beforeSlide:function(t,e){var n,s=this._Elems;s.shiftedButtons||(s.shiftedButtons=s.controlNext.add(s.controlPrev),this._State.controlHeight=r(s.shiftedButtons)),d.call(this,e),this._State.firstClick||(this._State.firstClick=!0,(n=s.Parent.attr(this._opts.attrs.clickCounter))&&((new Image).src="//rs.mail.ru/sb"+n+".gif?r="+Math.round(1e11*Math.random())))},slide:function(e,n){for(var s=[n],r=t(),c=1;c<=this._opts.preloadDepth;c++)s.push(n+c),n-c>=0&&s.push(n-c);s.forEach((function(t){r=r.add(u.call(this,t))}),this);var h=u.call(this,n,!0);r&&r.length&&i.call(this,r),clearTimeout(this._State.watchTimeoutId),h&&h.length?l.call(this,h):this._State.frameHeight=a.call(this,n),o.call(this),this.update()}},_Init:function(){this._State||(this._State={}),i.call(this,h.call(this)),l.call(this,u.call(this,0)),this._Elems.content.on("documentHeightChange",o.bind(this))}},{cssSels:{lazyEmbed:".js-slider__lazyembed"},cssClss:{animatedControl:"animated"},attrs:{activated:"data-embed-activated",type:"data-type",clickCounter:"data-first-click",resizable:"data-embed-resizable"},embedTypesToWatch:["vk_post"],preloadDepth:1,checkHightTimeout:500,minItemHeight:300},"EmbedList")}(window.jQuery||window.$,window,window.ru.mail.cpf)},582:function(t,e){!function(t,e,n){"use strict";var s,i=n.Basic,o=i.getView,r=i.Extend,a=i.moduleOpts.setParams,l=n.Tools,c=l.getTemplate,u=n.Modules.AsyncForms,h={};h.FoundMistake=o((s=function(){var n,s,i,o,r,a=!("getSelection"in e),l=a?document.selection.createRange():e.getSelection();if(!t(a?l.parentElement():l.anchorNode).closest(this._Elems.Parent)||"None"===l.type)return!1;if(a)l.expand("word"),(n=e.document.selection.createRange()).moveStart("character",-20),n.setEndPoint("EndToStart",l),n.expand("word"),s=n.text,n.moveEnd("character",20),n.setEndPoint("StartToEnd",l),n.expand("word"),i=n.text,o=l.text;else{if(!l.getRangeAt)return!1;r=l.getRangeAt(0),(n=e.opera?l.getRangeAt(0):document.createRange()).setStartBefore(r.startContainer),n.setEnd(r.startContainer,r.startOffset),(s=n.toString()).length>30&&(s=s.substr(s.length-30).replace(/^\S{1,10}\s+/,"")),n.setStart(r.endContainer,r.endOffset),n.setEndAfter(r.endContainer),(i=n.toString()).length>30&&(i=i.substr(0,30).replace(/\s+\S{1,10}$/,"")),o=l.toString()}return[s,"[",o,"]",i].join("").replace(/\r?\n?/g,"")},{_Events:[],_Handlers:{dom:{"keydown:document":"_onKeydown"}},_onKeydown:function(t){if(t.ctrlKey&&13==t.keyCode){var n=this._Opts,i=s.call(this);i&&new u({serverApi:{send:{url:n.url}},Templates:{form:c(n.templates.form)},validateOnChange:!1,templateParams:{mistake:!0,url:e.location.href,text:i},transport:function(t){return t.csrf=!0,t.type="POST",l.transport(t)}},null).Show()}}}),{url:"/ajax/send_feedback/",templates:{form:"ct-feedback.xml"}},null,"FoundMistake"),a({paramAttrs:{url:"data-action"}}),r(!0,n,{Modules:h})}(window.jQuery||window.$,window,window.ru.mail.cpf)},583:function(t,e){!function(t,e,n){"use strict";(0,n.Basic.moduleOpts.setParams)("CompareTable.Embed",{options:{cssSels:{Main:{tables:".js-compare-table__table",rows:".js-compare-table__tr"}},cssClss:{table:"js-compare-table__table",row:"js-compare-table__tr",rowHover:"over-hover"}}})}(window.jQuery||window.$,window,window.ru.mail.cpf)},59:function(t,e){!function(t,e,n,s){"use strict";var i=n.Basic,o=i.getByPath,r=n.Tools.initModules,a=["splashShow"],l="Не найден контейнер для вставки последнего, дополнительного кадра галереи",c="Не найден шаблон для типа ";function u(){var t=this._elems.splash;if(!t||!t.length){if(!(t=this._elems.parent.find(this._opts.cssSels.Main.splash)).length)return null;this._elems.splash=t}return t}i.Constructors.addPlugin("PopupGalleryView",{_Handlers:{dom:{"click:restart":"_onRestartClick","click:galleryLink":"_onGalleryLinkClick"},model:{splash:"_onSplash",loadStart:"_onLoadStart",loadFinish:"_onLoadFinish",loadError:"_onLoadError"}},_Init:function(){this._addEventTypes(a)},_onRestartClick:function(t){t.preventDefault(),this._Model.changeImage(0)},_onGalleryLinkClick:function(t){var e=t.currentTarget.getAttribute(this._opts.attrs.galleryId);e&&this._Model.loadGallery(e),t.preventDefault()},_onImageChange:function(){var t;this._state.splashActive&&(this._state.splashActive=!1,t=this._opts.cssClss,this._elems.parent.removeClass(t.showSplash+" "+t.showSplashBlock),null!==this._elems.splash&&(this._elems.splash.empty(),this._elems.splash=null)),this._super.apply(this,arguments)},_onPopupToggle:function(t){var e,n;t&&(e=this._Model).getCurrentImage().image>=(n=e._getCurrentSetImages().length)&&e.changeImage(n-1),this._super.apply(this,arguments)},_renderTemplate:function(n){var i=this._opts,a=i.attrs,h=i.cssClss,d=i.cssSels,p=this._elems.parent,m=u.call(this),f=this._slider.getCurrentFrame(),g=t(f).attr(a.splashType),_=o("_opts.templates.splash",this),v="function"==typeof _,w=v?_:_[g],b=v?n:n&&n[g];if(this._state.splashActive=!0,w)return Promise.resolve(w).then((function(n){v?m.append(n(b)):(t(d.Main.splash).not(f).addClass(h.splashLoading),t(f).html(n(b)),r(f),t(f).removeClass(h.splashLoading)),p.addClass(h.showSplash),h.showSplashBlock&&e.requestAnimationFrame(p.addClass.bind(p,h.showSplashBlock))}));s&&(v?e.console.error(l):e.console.error(c+g))},_onSplash:function(t){if(this._state.visible){var e=this._opts,n=t,s=u.call(this);s&&("function"==typeof e.prepareSplashJSON&&(n=e.prepareSplashJSON(n)),this._renderTemplate(n).then(this._trigger.bind(this,"splashShow",s,!0)))}},_onLoadStart:function(){},_onLoadFinish:function(){},_onLoadError:function(){}},{cssSels:{Main:{splash:".js-splash"},restart:".js-splash__restart",galleryLink:".js-splash__item__link"},cssClss:{showSplash:"pbox_viewmore_preshown",showSplashBlock:"pbox_viewmore_shown",splashLoading:"splash_loading"},templates:{splash:null},attrs:{galleryId:"data-gallery-id",splashType:"data-splash-type"},prepareSplashJSON:null},"Splash")}(window.$,window,window.ru.mail.cpf,window.DEBUG)},60:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=n.Tools.loadSlot,o=["splashBannerShow"];s.Constructors.addPlugin("PopupGalleryView",{_Handlers:{model:{loadStart:"_onLoadSplashStart",loadFinish:"_onLoadSplashFinish",loadError:"_onLoadSplashError"}},_Init:function(){this._addEventTypes(o),this._state||(this._state={}),this._state.splashInited=!1,this.on("splashShow",this._onSplashShow.bind(this))},_onLoadSplashStart:function(t){if("splash"===t){var e=this._model.getCurrentImage(),n=e&&this._getImageFrames(e.image);if(n){var s=this._opts,i=s.cssSels,o=n.frame;o.is(i.splashParent)&&o.addClass(s.cssClss.Loading)}}},_onLoadSplashFinish:function(){},_onLoadSplashError:function(){},_onSplashShow:function(t,e){this._showSplashBanner(t,e)},_showSplashBanner:function(t,n){if(!this._state.splashInited||n){this._state.splashInited=!0;var s=this._opts,o=s.cssClss.Loading,r=s.attrs.slotId;return new Promise((function(e,n){var o=t.find(s.cssSels.splashSlot);o.length||n("cont");var a=o.eq(0),l=s.splashBannerParams.slotId||a.attr(r);l||n("slotId"),i({slot:l,container:a}).then((function(t){t?e():n("slotFail")}),(function(){n("slotFail")}))})).then(function(){t.removeClass(o),this._trigger("splashBannerShow")}.bind(this),(function(n){t.removeClass(o),function(t){if(e.DEBUG){var n;switch(t){case"cont":n="Не найден контейнер для слота";break;case"slotId":n="Не указан ID для слота для слота";break;case"slotFail":n="Не удалось получить данные из слота";break;default:n=t}e.console.warn(n)}}(n)}))}}},{cssSels:{splashParent:".js-splash",splashSlot:".js-splash_slot"},attrs:{slotId:"data-slot-id"},splashBannerParams:{slotId:null}},"SplashBanner")}(window.jQuery,window,window.ru.mail.cpf)},61:function(t,e){!function(t,e){"use strict";(0,window.ru.mail.cpf.Basic.Constructors.addPlugin)("ImageView",{_Handlers:{model:{showSplash:function(t){var e=this._slider;if(e){var n=t.imageId;n?(e.goToPage(n),e.getPagesCount()>n&&this._model.postMessage({name:"controls",value:{disable:!1}})):e.goToPage(e.getPagesCount()-1)}}}}},{},"ImageViewSliderSplash")}(window.$)},79:function(t,e,n){var s=n(0)(n(1));!function(t,e,n){"use strict";var i=n.Tools,o=i.Auth,r=i.jQuery&&i.jQuery.showLoginPopup;function a(t,e,n,i){var a="function"==typeof t;return a&&"object"===(0,s.default)(e)&&!Array.isArray(e)&&"[object Arguments]"!==e.toString()&&(n=e,e=[]),new Promise((function(s){o.onGetStatus((function(o){o&&a?s(t.apply(n,e)):(i&&a&&r(),s(o))}))}))}i.applyAuth=function(t,e,n){return a(t,e,n)},i.applyAuthForce=function(t,e,n){return a(t,e,n,!0)}}(window.jQuery||window.$,window,window.ru.mail.cpf)},9:function(t,e,n){"use strict";function s(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),s(n(32)),s(n(33))},92:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.debounce,i=n.Basic.Constructors.getView,o=t(e),r=" ",a=navigator.userAgent.match(/Edge\/([0-9]+)\./);a=a&&a[1]>=17;var l={cssSels:{menuItems:".js-anchormenu__item",scrolledCont:"html"},cssClss:{itemActive:"active"},attributes:{menuItemName:"data-anchor",anchorName:"name"},lastItemValue:"",offsetTop:55,animationTime:1e3,canUpdatePageUrl:!0};i(function(){function n(){if(void 0!==e.pageXOffset&&void 0!==e.pageYOffset)return{left:e.pageXOffset,top:e.pageYOffset};var t=document.documentElement||document.body.parentNode||document.body;return{left:t.scrollLeft,top:t.scrollTop}}function i(e,n){return t("id"===e?"#"+n:"["+e+"="+n+"]").first()}var l=function(t,s){var i=this._state,o=this._Elems.scrolledCont.get(0),r=a?n().top:o.scrollTop;if(t==r)return Promise.resolve();var l=s/5,c=[];return new Promise((function(n){var s=0,u=setInterval((function(){if(s++,i.abortAnimation)s=l;else{var h=l?(t-r)/l*s+r:t;a?e.scroll(0,h):o.scrollTop=h}s>=l&&(clearInterval(u),c.pop(),c.length||n())}),5);c.push(u)}))},c=function(t,e){var n=this._state,s=this._Elems.scrolledCont||[];!n.animationInProgress&&s.length>0&&(n.animationInProgress=!0,l.call(this,Math.round(t)||0,e||this._opts.animationTime).then(function(){n.animationInProgress=!1,n.abortAnimation=!1,h.call(this)}.bind(this)))},u=function(t){var e=this._opts.cssClss.itemActive,n=this._Elems.menuItems;n&&(t&&(n=n.not(t),t.get(0)==document.activeElement&&t.blur()),n.removeClass(e),t&&t.addClass(e))},h=function(){var t=this._state;if(!t.animationInProgress){var e,s=n().top,i=t.sizes.document.height-t.sizes.window.height<=s,o=t.nodes,r=this._opts.offsetTop||0,a=o[o.length-1].isTheEnd?o.slice(-2)[0]:o.slice(-1)[0],l=o.filter((function(t){return t.anchorItem.get(0).getBoundingClientRect().top<r})).slice(-1)[0];i&&l!==a&&(l=a),l?l!==t.active&&(t.active=l,l.isTheEnd?(u.call(this),e=" "):(u.call(this,l.menuItem),e=l.menuItem.attr("href")),this._trigger("change",l)):(t.active=null,u.call(this),e=" "),m.call(this,e)}},d=function(){var n=this._state,s=e.document.documentElement,i=t(e.document);n.sizes={window:{width:s.clientWidth,height:s.clientHeight},document:{width:i.width(),height:i.height()}},n.nodes=p.call(this)},p=function(){var e=this._Elems,n=this._opts,s=n.attributes,o=s.menuItemName,r=s.anchorName,a=n.lastItemValue,l=e.menuItems=e.parent.find(n.cssSels.menuItems);e.anchorItems=t();var c=(l||[]).toArray().reduce((function(e,n){var s=n.getAttribute(o);return e.some((function(t){return t.name===s}))||(e=e.concat({name:s,menuItem:t("["+o+"="+s+"]")})),e}),[]).reduce((function(t,n){var s=i(r,n.name);return s.length&&(e.anchorItems=e.anchorItems.add(s),t=t.concat({name:n.name,menuItem:n.menuItem,anchorItem:s})),t}),[]);if(a){var u=i(r,a);u.length&&c.push({name:a,isTheEnd:!0,anchorItem:u})}return c},m=function(t){this._opts.canUpdatePageUrl&&t&&t!==r&&history&&history.replaceState&&(history.replaceState(null,null,t),r=t)};return{_Events:["change","itemChoose"],_Handlers:{dom:{"click:menuItems":function(t){t.preventDefault();var e=this._state,s=this._opts,i=t.currentTarget.getAttribute(s.attributes.menuItemName),o=this.getItem(i);if(o){var r=n(),a=o.anchorItem.get(0).getBoundingClientRect();e.animationInProgress||(u.call(this,o.menuItem),m.call(this,o.menuItem.attr("href")||"#"+i),c.call(this,r.top+a.top-s.offsetTop+1))}else e.animationInProgress||m.call(this,"#"+i);this._trigger("itemChoose",o)}}},getItem:function(t){var e=this._state,n=null;return e.nodes||(e.nodes=p.call(this)),t&&e.nodes.some((function(e){if(e.name===t)return n=e,!0})),n},_Init:function(){var n,i=this._elems,r=this._opts,a=this._state={},l=d.bind(this),c=h.bind(this),u=this.getItem.bind(this);i.scrolledCont=t(r.cssSels.scrolledCont),i.body=t("body"),l(),c(),o.on("load",(function(){var t=e.location.hash;l(),(e.instgrm&&e.instgrm.Embeds||e.FB&&e.FB.XFBML||e.VK&&e.VK.Widgets||e.twttr&&e.twttr.widgets)&&setTimeout(l,5e3),(n=t&&u(t.replace(/^#/,"")))&&n.menuItem.trigger("click")})).on("resize",s(l)).on("scroll",c).on("wheel",(function(){a.animationInProgress&&(a.abortAnimation=!0)}))}}}(),l,null,"AnchorMenu")}(window.jQuery||window.$,window,window.ru.mail.cpf)},94:function(t,e){!function(t,e,n){"use strict";var s=n.Basic,i=n.Mixins,o=s.getModel,r=s.Extend;o(function(){function t(t){t=t||{};var e=this._opts,n=e.transport||this.transport,s=e.urls,i=r(!0,{},e.requestParams,t);n({url:s.get_status,csrf:!0,type:"POST",data:i}).then(function(t){1===t.status&&(this.setState(t.data),this._trigger("update"))}.bind(this))}function e(t){t=t||{};var e=this._opts,n=this._state,s=e.urls,i=this.isSubscribed()?s.unsubscribe:s.subscribe,o=r(!0,{},e.requestParams,t),a=e.transport||this.transport;n.loading||(n.loading=!0,this._trigger("loading"),a({url:i,csrf:!0,type:"POST",data:o}).then(function(t){n.loading=!1,1===t.status?(n=r(!0,n,t.data),this._trigger("update")):this._trigger("error")}.bind(this),function(){n.loading=!1,this._trigger("error")}.bind(this)))}return{_Events:["loading","update","error"],_mixins:[i.transport],_Init:function(){this._state={},t.call(this)},isSubscribed:function(){var t=this._state.is_subscribed;return void 0===t?null:1===t},toggle:function(t){e.call(this,t)},setState:function(t){this._state=r(this._state,t)},getState:function(){return r(!0,{},this._state)}}}(),{urls:{subscribe:null,unsubscribe:null},transport:null,requestParams:{}},null,"NewsletterModel")}(window.jQuery||window.$,window,window.ru.mail.cpf)},95:function(t,e){!function(t,e,n){"use strict";var s=n.Basic.getView,i=n.Basic.moduleOpts.setParams,o=n.Tools.applyAuth,r=n.Types.String.Url.getParams;s(function(){function t(){var t=this._elems,e=this._opts.cssClss,n=this._model,s=t.toggleElem,i=n.isSubscribed();(s||{}).length&&null!==i&&s.toggleClass(e.subscribed,i)}return{_Events:["noAuth","checkUser"],_Handlers:{dom:{"click:Main.button":function(){var t=this._model,e={};o().then(function(n){n?(t._state.announce&&(e.announce_model=t._state.announce),t.toggle(e)):this._trigger("noAuth")}.bind(this))}},model:{update:t}},_Init:function(){var n=this._opts,s=this._model,i=this._elems;if(i.toggleElem=n.toggleParent?i.parent:i.toggleElem,n.checkOnInit&&this._trigger("checkUser"),t.call(this),e.location.search){var o=r(e.location.search);o&&1===o[n.paramName]&&(s.setState({is_subscribed:1}),s.toggle())}},_getActiveUser:function(){var t=this._elems.tooltipInput;n.Tools.Auth.onGetStatus(function(e){t&&t.length&&(t.val(e),t.prop("disabled",!!e))}.bind(this))}}}(),{cssSels:{Main:{button:".js-newsletter__button",toggleElem:".js-newsletter__toggle"}},cssClss:{subscribed:"button_toggle"},paramName:"unsubscribe",toggleParent:!1,checkOnInit:!1},null,"NewsletterView"),i("NewsletterView",{acceptTypes:["NewsletterModel"]})}(window.jQuery||window.$,window,window.ru.mail.cpf)}})}));
//# sourceMappingURL=page-article.js.map